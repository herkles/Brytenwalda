namespace = bryten_heresy

#######################################
# Bogomilism 
#######################################
bryten_heresy.001 = {# Bogomil begins preaching
	hidden = yes

	immediate = {
		random_county_in_region = {
			region = custom_bogomilist_region
			save_scope_as = bogomilism_county
		}
		create_character = {# Bogomil
			name = "Bogomil"
			gender = male
			location = scope:bogomilism_county.title_province
			age = 32
			faith = faith:bogomilist
			culture = culture:bulgarian
			trait = heresiarch
			trait = theologian
			trait = education_learning_3
			save_scope_as = bogomil_founder
		}
		create_character = {# Jeremiah
			name = "Jeremiah"
			gender = male
			location = scope:bogomilism_county.title_province
			age = 18
			faith = faith:bogomilist
			culture = culture:bulgarian
			trait = heresiarch
			trait = theologian
			trait = education_learning_4
			save_scope_as = bogomil_jeremiah
		}		
		set_global_variable = {
			name = bogomilism_spawned
			value = yes
		}
		# Unlock Bogomilism to convert to and be a heresy more generally
		faith:bogomilist = { remove_doctrine = unavailable_doctrine }
		every_county_in_region = {# Convert counties in the Balkans from Orthodoxy to Bogomilism
			region = custom_bogomilist_region
			limit = {# this should only apply to Ecumenical faiths, ie catholic and Orthodox mainly.
				faith = {
					NOT = { this = faith:bosnian_church }
					has_doctrine = special_doctrine_ecumenical_christian
				}
			}
			random = {
				chance = 5
				set_county_faith = faith:bogomilist
				add_county_modifier = {
					modifier = rebellious_people
					years = 10
				}
			}
		}
		every_ruler = {# give people the ability to convert
			limit = { capital_province = { geographical_region = custom_bogomilist_region } }
			trigger_event = {
				id = bryten_heresy.002
				days = { 30 50 }
			}
		}
		
	}
}
bryten_heresy.002 = {# Bogomil preaches
	type = character_event
	title = bryten_heresy.002.t
	desc = bryten_heresy.002.desc
	theme = faith	
	left_portrait = {
		character = root
		animation = personality_zealous
	}

	option = {# Condemn the heretic
		name = bryten_heresy.002.a
		ai_chance = { base = 89	}
		every_vassal = {# Zealous Vassals love it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = approves_heretic_condemnation
				target = root
				opinion = 40
			}
		}
	}
	option = {# Let him preach
		name = bryten_heresy.002.b
		ai_chance = { base = 20	} # rare 
		every_vassal = {# Zealous Vassals hate it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = disapproves_heretic_toleration
				target = root
				opinion = -40
			}
		}
		every_held_title = {# Bogomilist counties are really happy
			limit = {
				tier = tier_county
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}	
		hidden_effect = {
			random = {# convert more areas to Bogomilism
				chance = 5
				every_held_title = {
					limit = {
						tier = tier_county
						NOT = { faith = faith:bogomilist }
					}
					set_county_faith = faith:bogomilist
				}
			}			
		}

	}
	option = {# he is interesting ideas
		name = bryten_heresy.002.c
		ai_chance = { base = 01	} # super rare mainly for players
		faith:bogomilist = { change_fervor = { 
			value = 5
			desc = bryten_fervor_gain_heretical_lord 
		} }
		set_character_faith = faith:bogomilist
		every_held_title = {# Bogomilist counties are really happy
			limit = {
				tier = tier_county
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}
	}	
}
# Council: Council gathers from all over
bryten_heresy.003 = {# council: Clergy gather from all over
	type = character_event
	title = bryten_heresy.003.t
	desc = bryten_heresy.003.desc
	theme = learning
	left_portrait = {
		character = scope:bogomil_council_host
		animation = personality_rational
	}
	right_portrait = {
		character = scope:bogomil_priest_at_council
		animation = chancellor
	}
	override_background = { reference = temple_scope }

	immediate = {
		# You are a heresiarch
		add_trait = heresiarch
		# Sort our locale.
		## First, whether this is a repeater.
		scope:council_1_venue = {
			## Preferring to chill at scope:bogomil_priest's place.
			if = {
				limit = { holder = scope:bogomil_priest }
				save_scope_as = council_2_venue
			}
			## But otherwise we take your capital.
			else = {
				scope:bogomil_council_host.capital_barony = { save_scope_as = council_2_venue }
			}
		}
		scope:council_2_venue = { save_scope_as = background_temple_scope }
		scope:bogomil_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = bogomil_priest_at_council
			}
		}
	}

	
	option = {# Naturally, I'll take a leading role in the discussions.
		name = bryten_heresy.003.a

		# You'll engage in learning debates.
		custom_tooltip = bryten_heresy.003.a.tt
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:debate
		}
		stress_impact = {
			gregarious = miniscule_stress_impact_loss
			shy = medium_stress_impact_gain
		}
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 0
		}
	}
	option = {# My influence will be more felt than seen...
		name = bryten_heresy.003.b
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:piety
		}
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 0
		}
	}
	option = {# This is a matter for the clergy alone.
		name = bryten_heresy.003.c
		custom_tooltip = bryten_heresy.003.c.tt
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:defaulted
		}
		stress_impact = {
			humble = miniscule_stress_impact_loss
			arrogant = major_stress_impact_gain
		}
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 100
		}
	}


	after = {
		trigger_event = {
			id = bryten_heresy.004
			days = {5 10}
		}
	}
}
# Council: How Gnostic are you
scripted_effect bryten_heresy_council_bogomil_monarchianism_effect = {
	faith:bogomilist = { add_doctrine = doctrine_pluralism_righteous }
}
scripted_effect bryten_heresy_council_bogomil_dualism_effect = {
	faith:bogomilist = {
		hidden_effect = { remove_doctrine = doctrine_pluralism_righteous }
		add_doctrine = doctrine_pluralism_fundamentalist
	}
}
scripted_effect bryten_heresy_council_bogomil_trinity_effect = {
	show_as_tooltip = {
		faith:bogomilist = {
			hidden_effect = { remove_doctrine = doctrine_pluralism_righteous }
			add_doctrine = doctrine_pluralism_pluralistic
		}
	}
}
bryten_heresy.004 = {# Council: How Gnostic are you
	type = character_event
	title = bryten_heresy.004.t
	desc = bryten_heresy.004.desc
	theme = diplomacy
	left_portrait = {
		character = scope:bogomil_council_host
		animation = personality_bold
	}
	right_portrait = {
		character = scope:bogomil_priest_at_council
		animation = personality_bold
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:bogomil_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:bogomil_priest_at_council }
			clear_saved_scope = bogomil_priest_at_council
		}
		## Now try to refresh it.
		scope:bogomil_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = bogomil_priest_at_council
			}
		}
	}

	option = {# Monarchianism
		name = bryten_heresy.004.a
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:bogomil_council_stance_gnostic = flag:bogomil_council_stance_monarchianism }
			}
		}
		if = {# going against Jeremiah himself is costly
				limit = { scope:bogomil_priest = {
					AND = {
						has_character_flag = bogomil_priest_is_jeremiah 
						scope:bogomil_council_stance_gnostic = flag:bogomil_council_stance_trinity 
					} 
				}
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_jeremiah_cost_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_bogomil_monarchianism_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.004.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.004.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_bogomil_monarchianism_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.004.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.004.a.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:bogomil_priest's preference.
						## Monarchianism.
						if = {
							limit = { scope:bogomil_council_stance_gnostic = flag:bogomil_council_stance_monarchianism }
							bryten_heresy_council_bogomil_monarchianism_effect = yes
						}
						## Dualism.
						if = {
							limit = { scope:bogomil_council_stance_gnostic = flag:bogomil_council_stance_dualism }
							bryten_heresy_council_bogomil_dualism_effect = yes
						}
						## Trinitarians.
						if = {
							limit = { scope:bogomil_council_stance_gnostic = flag:bogomil_council_stance_trinity }
							bryten_heresy_council_bogomil_trinity_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 0
		}
	}
	option = {# Absolute Dualism
		name = bryten_heresy.004.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:bogomil_council_stance_gnostic = flag:bogomil_council_stance_dualism }
			}
		}
		if = {# going against Bogomil himself is supper costly
			limit = { scope:bogomil_priest = { has_character_flag = bogomil_priest_is_bogomil }
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_bogomil_cost_value
				multiply = -1
			}
		}
		if = {# Piety path.
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_bogomil_dualism_effect = yes
		}
		if = {# Debate path.
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.004.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.004.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_bogomil_dualism_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.004.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.004.b.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:bogomil_priest's preference.
						## Monarchianism.
						if = {
							limit = { scope:bogomil_council_stance_gnostic = flag:bogomil_council_stance_monarchianism }
							bryten_heresy_council_bogomil_monarchianism_effect = yes
						}
						## Trinitarians.
						if = {
							limit = { scope:bogomil_council_stance_gnostic = flag:bogomil_council_stance_trinity }
							bryten_heresy_council_bogomil_trinity_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 0
		}
	}
	option = {# Close to Trinitarianism
		name = bryten_heresy.004.c
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:bogomil_council_stance_gnostic = flag:bogomil_council_stance_trinity }
			} 
		}
		if = {# going against Bogomil himself is supper costly
			limit = { scope:bogomil_priest = { has_character_flag = bogomil_priest_is_bogomil }
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_bogomil_cost_value
				multiply = -1
			}
		}
		if = {# going against Jeremiah himself is costly
				limit = { scope:bogomil_priest = {
					AND = {
						has_character_flag = bogomil_priest_is_jeremiah 
						scope:bogomil_council_stance_gnostic = flag:bogomil_council_stance_monarchianism 
					} 
				}
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_jeremiah_cost_value
				multiply = -1
			}
		}

		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_bogomil_trinity_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.004.c.tt.success
					send_interface_toast = {
						title = bryten_heresy.004.c.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_bogomil_trinity_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.004.c.tt.failure
					send_interface_toast = {
						title = bryten_heresy.004.c.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:bogomil_priest's preference.
						## Monarchianism.
						if = {
							limit = { scope:bogomil_council_stance_gnostic = flag:bogomil_council_stance_monarchianism }
							bryten_heresy_council_bogomil_monarchianism_effect = yes
						}
						## Felicians.
						if = {
							limit = { scope:bogomil_council_stance_gnostic = flag:bogomil_council_stance_dualism }
							bryten_heresy_council_bogomil_dualism_effect = yes
						}
					}
				}
			}
		}

		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 0
		}
	}
	option = {# I have no opinion on this matter.
		name = bryten_heresy.004.d

		# We take scope:bogomil_priest's preference.
		## Monararchianism.
		if = {
			limit = { scope:bogomil_council_stance_gnostic = flag:bogomil_council_stance_monarchianism }
			bryten_heresy_council_bogomil_monarchianism_effect = yes
		}
		## Dualism.
		if = {
			limit = { scope:bogomil_council_stance_gnostic = flag:bogomil_council_stance_dualism }
			bryten_heresy_council_bogomil_dualism_effect = yes
		}
		## Trinity.
		if = {
			limit = { scope:bogomil_council_stance_gnostic = flag:bogomil_council_stance_trinity }
			bryten_heresy_council_bogomil_trinity_effect = yes
		}

		# We don't charge stress for the opt-outs, not least because their results are variable.
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.005
			days = {5 10}
		}
	}
}
# Council: priesthood
scripted_effect bryten_heresy_council_bogomil_hof_effect = {
	faith:bogomilist = { 
		hidden_effect = { remove_doctrine = doctrine_theocracy_lay_clergy }
		add_doctrine = doctrine_theocracy_temporal
		add_doctrine = doctrine_spiritual_head
		set_up_dynamic_spiritual_hof_title_effect = { CREATOR = scope:bogomil_council_host }
	}
}
scripted_effect bryten_heresy_council_bogomil_spiritual_effect = {
	faith:bogomilist = { 
		hidden_effect = { remove_doctrine = doctrine_theocracy_lay_clergy }
		add_doctrine = doctrine_theocracy_temporal 
	}
}
scripted_effect bryten_heresy_council_bogomil_lay_priests_effect = {
	faith:bogomilist = { 
		add_doctrine = doctrine_theocracy_lay_clergy 
	}
}
bryten_heresy.005 = {# Council: priesthood
	type = character_event
	title = bryten_heresy.005.t
	desc = bryten_heresy.005.desc
	theme = martial
	left_portrait = {
		character = scope:bogomil_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:bogomil_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:bogomil_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:bogomil_priest_at_council }
			clear_saved_scope = bogomil_priest_at_council
		}
		## Now try to refresh it.
		scope:bogomil_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = bogomil_priest_at_council
			}
		}
	}

	option = {# spritual + Head of Faith
		name = bryten_heresy.005.a
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:bogomil_council_stance_clergy = flag:bogomil_council_stance_patriarch }
			}
		}
		if = {# going against Bogomil himself is supper costly
			limit = { scope:bogomil_priest = { has_character_flag = bogomil_priest_is_bogomil }
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_bogomil_cost_value
				multiply = -1
			}
		}
		if = {# going against Jeremiah himself is costly
				limit = { scope:bogomil_priest = {
					AND = {
						has_character_flag = bogomil_priest_is_jeremiah 
						scope:bogomil_council_stance_clergy = flag:bogomil_council_stance_priests 
					} 
				}
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_jeremiah_cost_value
				multiply = -1
			}
		}

		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_bogomil_hof_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.005.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.005.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_bogomil_hof_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.005.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.005.a.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:bogomil_priest's preference.
						## spiritual.
						if = {
							limit = { scope:bogomil_council_stance_clergy = flag:bogomil_council_stance_priests }
							bryten_heresy_council_bogomil_spiritual_effect = yes
						}
						## lay priests.
						if = {
							limit = { scope:bogomil_council_stance_clergy = flag:bogomil_council_stance_lay_clergy }
							bryten_heresy_council_bogomil_lay_priests_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 0
		}
	}
	option = {# Spiritual without HoF
		name = bryten_heresy.005.b
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:bogomil_council_stance_clergy = flag:bogomil_council_stance_priests }
			}
		}
		if = {# going against Bogomil himself is supper costly
			limit = { scope:bogomil_priest = { has_character_flag = bogomil_priest_is_bogomil }
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_bogomil_cost_value
				multiply = -1
			}
		}
		if = {# going against Jeremiah himself is costly
				limit = { scope:bogomil_priest = {
					AND = {
						has_character_flag = bogomil_priest_is_jeremiah 
						scope:bogomil_council_stance_clergy = flag:bogomil_council_stance_patriarch 
					} 
				}
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_jeremiah_cost_value
				multiply = -1
			}
		}
		
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_bogomil_spiritual_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.005.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.005.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_bogomil_spiritual_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.005.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.005.b.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:bogomil_priest's preference.
						## Spiritual + HoF.
						if = {
							limit = { scope:bogomil_council_stance_clergy = flag:bogomil_council_stance_patriarch }
							bryten_heresy_council_bogomil_hof_effect = yes
						}
						## Lay priests.
						if = {
							limit = { scope:bogomil_council_stance_clergy = flag:bogomil_council_stance_lay_clergy }
							bryten_heresy_council_bogomil_lay_priests_effect = yes
						}
					}
				}
			}
		}

		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 0
		}
	}
	option = {# Lay priesthood
		name = bryten_heresy.005.c
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:bogomil_council_stance_clergy = flag:bogomil_council_stance_lay_clergy }
			}
		}
		if = {# going against Jeremiah himself is costly
			limit = { scope:bogomil_priest = { has_character_flag = bogomil_priest_is_jeremiah }
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_bogomil_cost_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_bogomil_lay_priests_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.005.c.tt.success
					send_interface_toast = {
						title = bryten_heresy.005.c.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_bogomil_lay_priests_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.005.c.tt.failure
					send_interface_toast = {
						title = bryten_heresy.005.c.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:bogomil_priest's preference.
						## Spiritual HoF.
						if = {
							limit = { scope:bogomil_council_stance_clergy = flag:bogomil_council_stance_patriarch }
							bryten_heresy_council_bogomil_spiritual_effect = yes
						}
						## Felicians.
						if = {
							limit = { scope:bogomil_council_stance_clergy = flag:bogomil_council_stance_priests }
							bryten_heresy_council_bogomil_hof_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 0
		}
	}
	option = {# The clergy decide
		name = bryten_heresy.005.d

		# We take scope:bogomil_priest's preference.
		## Patriarch.
		if = {
			limit = { scope:bogomil_council_stance_clergy = flag:bogomil_council_stance_patriarch }
			bryten_heresy_council_bogomil_hof_effect = yes
		}
		## Spiritual.
		if = {
			limit = { scope:bogomil_council_stance_clergy = flag:bogomil_council_stance_priests }
			bryten_heresy_council_bogomil_spiritual_effect = yes
		}
		## Lay Priest.
		if = {
			limit = { scope:bogomil_council_stance_clergy = flag:bogomil_council_stance_lay_clergy }
			bryten_heresy_council_bogomil_lay_priests_effect = yes
		}
		# We don't charge stress for the opt-outs, not least because their results are variable.
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.006
			days = {5 10}
		}
	}
}
# Council: wealth
scripted_effect bryten_heresy_council_bogomil_share_effect = {
	faith:bogomilist = { 
		add_doctrine = tenet_communal_possessions }
}
scripted_effect bryten_heresy_council_bogomil_shun_effect = {
	faith:bogomilist = { 
		hidden_effect = { remove_doctrine = tenet_communal_possessions }
		add_doctrine = tenet_apostolic_poverty 
	}
}
scripted_effect bryten_heresy_council_bogomil_pure_effect = {
	faith:bogomilist = { 
		hidden_effect = { remove_doctrine = tenet_communal_possessions }
		add_doctrine = tenet_pure_priesthood 
	}
}
bryten_heresy.006 = {# Council: wealth
	type = character_event
	title = bryten_heresy.006.t
	desc = bryten_heresy.006.desc
	theme = martial
	left_portrait = {
		character = scope:bogomil_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:bogomil_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:bogomil_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:bogomil_priest_at_council }
			clear_saved_scope = bogomil_priest_at_council
		}
		## Now try to refresh it.
		scope:bogomil_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = bogomil_priest_at_council
			}
		}
	}

	option = {# Share Wealth
		name = bryten_heresy.006.a
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:bogomil_council_stance_wealth = flag:bogomil_council_stance_share_wealth }
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_bogomil_share_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.006.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.006.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_bogomil_share_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.006.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.006.a.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:bogomil_priest's preference.
						## Shun.
						if = {
							limit = { scope:bogomil_council_stance_wealth = flag:bogomil_council_stance_shun_wealth }
							bryten_heresy_council_bogomil_shun_effect = yes
						}
						## Pure.
						if = {
							limit = { scope:bogomil_council_stance_wealth = flag:bogomil_council_stance_pure_priests }
							bryten_heresy_council_bogomil_pure_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 0
		}
	}
	option = {# Shun Wealth
		name = bryten_heresy.006.b
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:bogomil_council_stance_wealth = flag:bogomil_council_stance_shun_wealth }
			}
		}
		if = {# going against Bogomil himself is supper costly
			limit = { scope:bogomil_priest = { has_character_flag = bogomil_priest_is_bogomil }
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_bogomil_cost_value
				multiply = -1
			}
		}
		if = {# going against Jeremiah himself is costly
			limit = { scope:bogomil_priest = { has_character_flag = bogomil_priest_is_jeremiah }
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_bogomil_cost_value
				multiply = -1
			}
		}

		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_bogomil_shun_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.006.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.006.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_bogomil_shun_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.006.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.006.b.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:bogomil_priest's preference.
						## Share Wealth.
						if = {
							limit = { scope:bogomil_council_stance_wealth = flag:bogomil_council_stance_share_wealth }
							bryten_heresy_council_bogomil_share_effect = yes
						}
						## Pure Priests.
						if = {
							limit = { scope:bogomil_council_stance_wealth = flag:bogomil_council_stance_pure_priests }
							bryten_heresy_council_bogomil_pure_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 0
		}
	}
	option = {# Pure Priesthood
		name = bryten_heresy.006.c
		trigger = {# Error checking, no lay clergy and pure
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	}
				NOT = {	faith:bogomilist = { has_doctrine = doctrine_theocracy_lay_clergy } }
				NOT = {	scope:bogomil_council_stance_wealth = flag:bogomil_council_stance_pure_priests }
			}
		}

		if = {# going against Bogomil himself is supper costly
			limit = { scope:bogomil_priest = { has_character_flag = bogomil_priest_is_bogomil }
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_bogomil_cost_value
				multiply = -1
			}
		}
		if = {# going against Jeremiah himself is costly
			limit = { scope:bogomil_priest = { has_character_flag = bogomil_priest_is_jeremiah }
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_bogomil_cost_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_bogomil_pure_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.006.c.tt.success
					send_interface_toast = {
						title = bryten_heresy.006.c.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_bogomil_pure_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.006.c.tt.failure
					send_interface_toast = {
						title = bryten_heresy.006.c.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:bogomil_priest's preference.
						## Share.
						if = {
							limit = { scope:bogomil_council_stance_wealth = flag:bogomil_council_stance_share_wealth }
							bryten_heresy_council_bogomil_share_effect = yes
						}
						## Shun.
						if = {
							limit = { scope:bogomil_council_stance_wealth = flag:bogomil_council_stance_shun_wealth }
							bryten_heresy_council_bogomil_shun_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 0
		}
	}
	option = {# The Clergy decide
		name = bryten_heresy.006.d

		# We take scope:bogomil_priest's preference.
		if = {# Share Wealth
			limit = { scope:bogomil_council_stance_wealth = flag:bogomil_council_stance_share_wealth }
			bryten_heresy_council_bogomil_share_effect = yes
		}
		if = {# Shun Wealth
			limit = { scope:bogomil_council_stance_wealth = flag:bogomil_council_stance_shun_wealth }
			bryten_heresy_council_bogomil_shun_effect = yes
		}
		if = {# Pure Priest
			limit = { scope:bogomil_council_stance_wealth = flag:bogomil_council_stance_pure_priests }
			bryten_heresy_council_bogomil_pure_effect = yes
		}

		# We don't charge stress for the opt-outs, not least because their results are variable.
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 100
		}
	}
	
	after = {
		trigger_event = {
			id = bryten_heresy.007
			days = { 5 10 }
		}
	}

}
# Council: pacifism
scripted_effect bryten_heresy_council_bogomil_armed_effect = {
	faith:bogomilist = { 
		add_doctrine = tenet_armed_pilgrimages 
	}
}
scripted_effect bryten_heresy_council_bogomil_pacifism_effect = {
	faith:bogomilist = { 
		hidden_effect = { remove_doctrine = tenet_armed_pilgrimages }
		add_doctrine = tenet_pacifism 
	}
}
scripted_effect bryten_heresy_council_bogomil_unrelenting_effect = {
	faith:bogomilist = { 
		hidden_effect = { remove_doctrine = tenet_armed_pilgrimages }
		add_doctrine = tenet_unrelenting_faith 
	}
}
bryten_heresy.007 = {# Council: Pacifism
	type = character_event
	title = bryten_heresy.007.t
	desc = bryten_heresy.007.desc
	theme = martial
	left_portrait = {
		character = scope:bogomil_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:bogomil_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:bogomil_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:bogomil_priest_at_council }
			clear_saved_scope = bogomil_priest_at_council
		}
		## Now try to refresh it.
		scope:bogomil_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = bogomil_priest_at_council
			}
		}
	}

	option = {# Armed Pilgirmages
		name = bryten_heresy.007.a
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:bogomil_council_stance_peace = flag:bogomil_council_stance_protect }
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_bogomil_armed_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.007.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.007.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_bogomil_armed_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.007.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.007.a.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:bogomil_priest's preference.
						## Pacifism.
						if = {
							limit = { scope:bogomil_council_stance_peace = flag:bogomil_council_stance_pacifism }
							bryten_heresy_council_bogomil_pacifism_effect = yes
						}
						## Unrelenting Faith.
						if = {
							limit = { scope:bogomil_council_stance_peace = flag:bogomil_council_stance_unrelenting }
							bryten_heresy_council_bogomil_unrelenting_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 0
		}
	}
	option = {# Pacifism
		name = bryten_heresy.007.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:bogomil_council_stance_peace = flag:bogomil_council_stance_pacifism }
			}
		}
		if = {# going against Bogomil himself is supper costly
			limit = { scope:bogomil_priest = { has_character_flag = bogomil_priest_is_bogomil }
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_bogomil_cost_value
				multiply = -1
			}
		}
		if = {# going against Jeremiah himself is costly
			limit = { scope:bogomil_priest = { has_character_flag = bogomil_priest_is_jeremiah }
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_bogomil_cost_value
				multiply = -1
			}
		}

		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_bogomil_pacifism_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.007.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.007.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_bogomil_pacifism_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.007.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.007.b.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:bogomil_priest's preference.
						## Armed Pilgrimages.
						if = {
							limit = { scope:bogomil_council_stance_peace = flag:bogomil_council_stance_protect }
							bryten_heresy_council_bogomil_armed_effect = yes
						}
						## Unrelenting Faith.
						if = {
							limit = { scope:bogomil_council_stance_peace = flag:bogomil_council_stance_unrelenting }
							bryten_heresy_council_bogomil_unrelenting_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 0
		}
	}
	option = {# Unrelenting Faith
		name = bryten_heresy.007.c
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:bogomil_council_stance_peace = flag:bogomil_council_stance_unrelenting }
			}
		}
		if = {# going against Bogomil himself is supper costly
			limit = { scope:bogomil_priest = { has_character_flag = bogomil_priest_is_bogomil }
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_bogomil_cost_value
				multiply = -1
			}
		}
		if = {# going against Jeremiah himself is costly
			limit = { scope:bogomil_priest = { has_character_flag = bogomil_priest_is_jeremiah }
			}
			add_piety = {
				value = bryten_bogomil_council_oppose_bogomil_cost_value
				multiply = -1
			}
		}

		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_bogomil_unrelenting_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.007.c.tt.success
					send_interface_toast = {
						title = bryten_heresy.007.c.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_bogomil_unrelenting_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.007.c.tt.failure
					send_interface_toast = {
						title = bryten_heresy.007.c.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:bogomil_priest's preference.
						## Armed Pilgrimages.
						if = {
							limit = { scope:bogomil_council_stance_peace = flag:bogomil_council_stance_protect }
							bryten_heresy_council_bogomil_armed_effect = yes
						}
						## Pacifism.
						if = {
							limit = { scope:bogomil_council_stance_peace = flag:bogomil_council_stance_pacifism }
							bryten_heresy_council_bogomil_pacifism_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 0
		}
	}
	option = {# Clergy Decide
		name = bryten_heresy.007.d

		if = {# Armed Pilgrimages
			limit = { scope:bogomil_council_stance_peace = flag:bogomil_council_stance_protect }
			bryten_heresy_council_bogomil_armed_effect = yes
		}
		if = {# Pacifism
			limit = { scope:bogomil_council_stance_peace = flag:bogomil_council_stance_pacifism }
			bryten_heresy_council_bogomil_pacifism_effect = yes
		}
		if = {# Unrelenting Faith
			limit = { scope:bogomil_council_stance_peace = flag:bogomil_council_stance_unrelenting }
			bryten_heresy_council_bogomil_unrelenting_effect = yes
		}

		ai_chance = {
			# The AI should just let the scope:bogomil_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.008
			days = {5 10}
		}
	}
}
# council results
bryten_heresy.008 = {# The church council arrives at their final important doctrinal conclusions.
	type = character_event
	title = bryten_heresy.008.t
	desc = {
		desc = bryten_heresy.008.desc.intro
		first_valid = {# Gnostic
			triggered_desc = {
				trigger = {	faith:bogomilist = { has_doctrine = doctrine_pluralism_pluralistic } }
				desc = bryten_heresy.008.desc.pluralist
			}
			triggered_desc = {
				trigger = {
					faith:bogomilist = { has_doctrine = doctrine_pluralism_righteous }
				}
				desc = bryten_heresy.008.desc.righteous
			}
			triggered_desc = {
				trigger = {
					faith:bogomilist = { has_doctrine = doctrine_pluralism_fundamentalist }
				}
				desc = bryten_heresy.008.desc.fundamentalist
			}
		}
		first_valid = {# Priesthood
			triggered_desc = {
				trigger = {	faith:bogomilist = { has_doctrine = doctrine_spiritual_head } }
				desc = bryten_heresy.008.desc.hof
			}
			triggered_desc = {
				trigger = {
					faith:bogomilist = { 
						NOT = {	has_doctrine = doctrine_spiritual_head }
						has_doctrine = doctrine_theocracy_temporal 
					}
				}
				desc = bryten_heresy.008.desc.priests
			}
			triggered_desc = {
				trigger = {	faith:bogomilist = { has_doctrine = doctrine_theocracy_lay_clergy }	}
				desc = bryten_heresy.008.desc.lay
			}
		}
		first_valid = {# Wealth
			triggered_desc = {
				trigger = {	faith:bogomilist = { has_doctrine = tenet_communal_possessions } }
				desc = bryten_heresy.008.desc.share
			}
			triggered_desc = {
				trigger = {	faith:bogomilist = { has_doctrine = tenet_apostolic_poverty } }
				desc = bryten_heresy.008.desc.shun
			}
			triggered_desc = {
				trigger = {	faith:bogomilist = { has_doctrine = tenet_pure_priesthood }	}
				desc = bryten_heresy.008.desc.pure
			}
		}
		first_valid = {# Peace
			triggered_desc = {
				trigger = {	faith:bogomilist = { has_doctrine = tenet_armed_pilgrimages } }
				desc = bryten_heresy.008.desc.armed
			}
			triggered_desc = {
				trigger = {	faith:bogomilist = { has_doctrine = tenet_pacifism } }
				desc = bryten_heresy.008.desc.pacifism
			}
			triggered_desc = {
				trigger = {	faith:bogomilist = { has_doctrine = tenet_unrelenting_faith }	}
				desc = bryten_heresy.008.desc.unrelenting
			}
		}
		# Outro.
		desc = bryten_heresy.008.desc.outro
	}
	theme = faith
	left_portrait = {
		character = scope:bogomil_council_host
		animation = personality_bold
	}
	right_portrait = {
		character = scope:bogomil_priest_at_council
		animation = chancellor
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Music!
		play_music_cue = "mx_cue_sacredrite"
		faith:bogomilist = {# the Council is over and now is formulized
			remove_doctrine = heretic_movement_doctrine
			change_fervor = { 
				value = 50
				desc = bryten_fervor_gain_bogomil_council	
			} 
		}
		# Now let's display our choices.
		faith:bogomilist = {
			show_as_tooltip = {
				# Gnosticism.
				if = {
					limit = { has_doctrine = doctrine_pluralism_righteous }
					add_doctrine = doctrine_pluralism_righteous
				}
				if = {
					limit = { has_doctrine = doctrine_pluralism_righteous }
					add_doctrine = doctrine_pluralism_righteous
				}
				if = {
					limit = { has_doctrine = doctrine_pluralism_pluralistic }
					add_doctrine = doctrine_pluralism_pluralistic
				}
				# Priesthood.
				if = {
					limit = { has_doctrine = doctrine_spiritual_head }
					add_doctrine = doctrine_theocracy_temporal
					add_doctrine = doctrine_spiritual_head
				}
				if = {
					limit = { 
						has_doctrine = doctrine_theocracy_temporal 
						NOT = { has_doctrine = doctrine_spiritual_head }
					}
					add_doctrine = doctrine_theocracy_temporal
				}
				if = {
					limit = { has_doctrine = doctrine_theocracy_lay_clergy }
					add_doctrine = doctrine_theocracy_lay_clergy
				}
				# Wealth.
				if = {
					limit = { has_doctrine = tenet_communal_possessions }
					add_doctrine = tenet_communal_possessions
				}
				if = {
					limit = { has_doctrine = tenet_apostolic_poverty }
					add_doctrine = tenet_apostolic_poverty
				}
				if = {
					limit = { has_doctrine = tenet_pure_priesthood }
					add_doctrine = tenet_pure_priesthood
				}
				# Pacifism.
				if = {
					limit = { has_doctrine = tenet_armed_pilgrimages }
					add_doctrine = tenet_armed_pilgrimages
				}
				if = {
					limit = { has_doctrine = tenet_pacifism }
					add_doctrine = tenet_pacifism
				}
				if = {
					limit = { has_doctrine = tenet_unrelenting_faith }
					add_doctrine = tenet_unrelenting_faith
				}
			}


		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:bryten_bogomilism_council_completed
		}


	}

	option = {
		name = bryten_heresy.008.a
		add_piety = major_piety_gain

	}

	after = {
		# Clean up the story.
		every_player = {# letting players know that the Bogomil church has been formalized
			trigger_event = {
				id = bryten_heresy.009
				days = {5 10}
			}
		}
	}
}
bryten_heresy.009 = {# Bogomil Council(let players know)
	type = character_event
	title = bryten_heresy.009.t
	desc = bryten_heresy.009.desc
	theme = faith	


	option = {# Condemn the heretic
		name = bryten_heresy.009.a
	}
	
}
#######################################
# Catharism 
#######################################
bryten_heresy.025 = {# Cathar Preachers come about
	hidden = yes

	immediate = {
		set_global_variable = {
			name = catharism_spawned
			value = yes
		}
		# Unlock Bogomilism to convert to and be a heresy more generally
		faith:cathar = { remove_doctrine = unavailable_doctrine }
		every_county_in_region = {# Convert counties in the Balkans from Orthodoxy to Bogomilism
			region = custom_cathar_region
			limit = {# this should only apply to Ecumenical faiths, ie catholic and Orthodox mainly.
				faith = {
					NOT = { this = faith:bosnian_church }
					has_doctrine = special_doctrine_ecumenical_christian
				}
			}
			random = {
				chance = 5
				set_county_faith = faith:cathar
				add_county_modifier = {
					modifier = rebellious_people
					years = 10
				}
			}
		}
		every_ruler = {# give people the ability to convert
			limit = { capital_province = { geographical_region = custom_cathar_region } }
			trigger_event = {
				id = bryten_heresy.026
				days = { 30 50 }
			}
		}
		
	}
}
bryten_heresy.026 = {# Convert to Catharism?
	type = character_event
	title = bryten_heresy.026.t
	desc = bryten_heresy.026.desc
	theme = faith
	
	
	left_portrait = {
		character = root
		animation = personality_zealous
	}
	
	immediate = {

	}

	option = {# Condemn the heretics
		name = bryten_heresy.026.a
		ai_chance = { base = 89	}
		every_vassal = {# Zealous Vassals love it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = approves_heretic_condemnation
				target = root
				opinion = 40
			}
		}
	}
	option = {# Let him preach
		name = bryten_heresy.026.b
		ai_chance = { base = 20	} # rare 
		every_vassal = {# Zealous Vassals hate it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = disapproves_heretic_toleration
				target = root
				opinion = -40
			}
		}
		every_held_title = {# Cathar counties are really happy
			limit = {
				tier = tier_county
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}	
		hidden_effect = {
			random = {# convert more areas to Bogomilism
				chance = 5
				every_held_title = {
					limit = {
						tier = tier_county
						NOT = { faith = faith:cathar }
					}
					set_county_faith = faith:cathar
				}
			}			
		}

	}
	option = {# he is interesting ideas
		name = bryten_heresy.026.c
		ai_chance = { base = 01	} # super rare mainly for players
		faith:cathar = { 
			change_fervor = { 
				value = 5
				desc = bryten_fervor_gain_heretical_lord	
			} 
		}
		set_character_faith = faith:cathar
		every_held_title = {# Cathar counties are really happy
			limit = {
				tier = tier_county
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}
	}	
}
#######################################
# Waldensian 
#######################################
bryten_heresy.050 = {# Waldo begins preaching
	hidden = yes

	immediate = {
		random_county_in_region = {
			region = custom_waldensian_region
			save_scope_as = Waldenism_county
		}
		create_character = {# Waldo
			name = "Peter"
			gender = male
			location = scope:Waldenism_county.title_province
			age = 30
			faith = faith:waldensian
			culture = culture:occitan
			trait = heresiarch
			trait = generous
			trait = theologian
			trait = improvident
			trait = education_learning_4
			save_scope_as = waldensian_founder
		}
		set_global_variable = {
			name = waldensian_spawned
			value = yes
		}
		# Unlock Bogomilism to convert to and be a heresy more generally
		faith:waldensian = { remove_doctrine = unavailable_doctrine }
		every_county_in_region = {# Convert counties in the Balkans from Orthodoxy to Bogomilism
			region = custom_waldensian_region
			limit = {# this should only apply to Ecumenical faiths, ie catholic and Orthodox mainly.
				faith = {
					has_doctrine = special_doctrine_ecumenical_christian
				}
			}
			random = {
				chance = 5
				set_county_faith = faith:waldensian
				add_county_modifier = {
					modifier = rebellious_people
					years = 10
				}
			}
		}
		every_ruler = {# give people the ability to convert
			limit = { capital_province = { geographical_region = custom_waldensian_region } }
			trigger_event = {
				id = bryten_heresy.051
				days = { 30 50 }
			}
		}
		
	}
}
bryten_heresy.051 = {# Convert to Waldensian?
	type = character_event
	title = bryten_heresy.051.t
	desc = bryten_heresy.051.desc
	theme = faith
	
	
	left_portrait = {
		character = root
		animation = personality_zealous
	}
	
	immediate = {

	}

	option = {# Condemn the heretics
		name = bryten_heresy.051.a
		ai_chance = { base = 89	}
		every_vassal = {# Zealous Vassals love it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = approves_heretic_condemnation
				target = root
				opinion = 40
			}
		}
	}
	option = {# Let him preach
		name = bryten_heresy.051.b
		ai_chance = { base = 20	} # rare 
		every_vassal = {# Zealous Vassals hate it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = disapproves_heretic_toleration
				target = root
				opinion = -40
			}
		}
		every_held_title = {# Waldenisans counties are really happy
			limit = {
				tier = tier_county
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}	
		hidden_effect = {
			random = {# convert more areas to waldensian
				chance = 5
				every_held_title = {
					limit = {
						tier = tier_county
						NOT = { faith = faith:waldensian }
						faith = {# this is to ensure its a reaction to catholicism not any other heretical movement
							has_doctrine = special_doctrine_ecumenical_christian
						}
					}
					set_county_faith = faith:waldensian
				}
			}			
		}

	}
	option = {# he is interesting ideas
		name = bryten_heresy.051.c
		ai_chance = { base = 01	} # super rare mainly for players
		faith:waldensian = { 
			change_fervor = { 
				value = 5
				desc = bryten_fervor_gain_heretical_lord	
			} 
		}
		set_character_faith = faith:waldensian
		every_held_title = {# waldensian counties are really happy
			limit = {
				tier = tier_county
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}
	}	
}
# Council: Council gathers from all over
bryten_heresy.052 = {# council: Clergy gather from all over
	type = character_event
	title = bryten_heresy.052.t
	desc = bryten_heresy.052.desc
	theme = learning
	left_portrait = {
		character = scope:waldensian_council_host
		animation = personality_rational
	}
	right_portrait = {
		character = scope:waldensian_priest_at_council
		animation = chancellor
	}
	override_background = { reference = temple_scope }

	immediate = {
		# You are a heresiarch
		add_trait = heresiarch
		# Sort our locale.
		## First, whether this is a repeater.
		scope:council_1_venue = {
			## Preferring to chill at scope:waldensian_priest's place.
			if = {
				limit = { holder = scope:waldensian_priest }
				save_scope_as = council_2_venue
			}
			## But otherwise we take your capital.
			else = {
				scope:waldensian_council_host.capital_barony = { save_scope_as = council_2_venue }
			}
		}
		scope:council_2_venue = { save_scope_as = background_temple_scope }
		scope:waldensian_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = waldensian_priest_at_council
			}
		}
	}

	
	option = {# Naturally, I'll take a leading role in the discussions.
		name = bryten_heresy.052.a

		# You'll engage in learning debates.
		custom_tooltip = bryten_heresy.052.a.tt
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:debate
		}
		stress_impact = {
			gregarious = miniscule_stress_impact_loss
			shy = medium_stress_impact_gain
		}
		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 0
		}
	}
	option = {# My influence will be more felt than seen...
		name = bryten_heresy.052.b
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:piety
		}
		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 0
		}
	}
	option = {# This is a matter for the clergy alone.
		name = bryten_heresy.052.c
		custom_tooltip = bryten_heresy.052.c.tt
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:defaulted
		}
		stress_impact = {
			humble = miniscule_stress_impact_loss
			arrogant = major_stress_impact_gain
		}
		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 100
		}
	}


	after = {
		trigger_event = {
			id = bryten_heresy.053
			days = {5 10}
		}
	}
}
# Council: The priesthood
scripted_effect bryten_heresy_council_waldensian_hof_effect = {
	faith:waldensian = { 
		hidden_effect = { remove_doctrine = doctrine_theocracy_lay_clergy }
		add_doctrine = doctrine_theocracy_temporal
		add_doctrine = doctrine_spiritual_head
		set_up_dynamic_spiritual_hof_title_effect = { CREATOR = scope:waldensian_council_host }
	}
}
scripted_effect bryten_heresy_council_waldensian_spiritual_effect = {
	faith:waldensian = { 
		hidden_effect = { remove_doctrine = doctrine_theocracy_lay_clergy }
		add_doctrine = doctrine_theocracy_temporal 
	}
}
scripted_effect bryten_heresy_council_waldensian_lay_priests_effect = {
	faith:waldensian = { 
		add_doctrine = doctrine_theocracy_lay_clergy 
	}
}
bryten_heresy.053 = {# Council: priesthood
	type = character_event
	title = bryten_heresy.053.t
	desc = bryten_heresy.053.desc
	theme = diplomacy
	left_portrait = {
		character = scope:waldensian_council_host
		animation = personality_bold
	}
	right_portrait = {
		character = scope:waldensian_priest_at_council
		animation = personality_bold
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:waldensian_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:waldensian_priest_at_council }
			clear_saved_scope = waldensian_priest_at_council
		}
		## Now try to refresh it.
		scope:waldensian_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = waldensian_priest_at_council
			}
		}
	}

	option = {# Spiritual + Hof
		name = bryten_heresy.053.a
		trigger = { 
			OR = {
				not = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:waldensian_council_stance_clergy = flag:waldensian_council_stance_hof	}
			}
		}
		if = {# going against Peter Waldo himself is costly
				limit = { scope:waldensian_priest = { has_character_flag = waldensian_priest_is_peter }
			}
			add_piety = {
				value = bryten_waldensian_council_oppose_peter_waldo_cost_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_waldensian_hof_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.053.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.053.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_waldensian_hof_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.053.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.053.a.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:waldensian_priest's preference.
						## Spiritual.
						if = {
							limit = { scope:waldensian_council_stance_clergy = flag:waldensian_council_stance_spiritual }
							bryten_heresy_council_waldensian_spiritual_effect = yes
						}
						## Lay Clergy.
						if = {
							limit = { scope:waldensian_council_stance_clergy = flag:waldensian_council_stance_lay_clergy }
							bryten_heresy_council_waldensian_lay_priests_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 0
		}
	}
	option = {# Spiritual
		name = bryten_heresy.053.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:waldensian_council_stance_clergy = flag:waldensian_council_stance_spiritual }
			}
		}

		if = {# going against Peter Waldo himself is costly
				limit = { scope:waldensian_priest = { has_character_flag = waldensian_priest_is_peter }
			}
			add_piety = {
				value = bryten_waldensian_council_oppose_peter_waldo_cost_value
				multiply = -1
			}
		}
		if = {# Piety path.
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_waldensian_spiritual_effect = yes
		}
		if = {# Debate path.
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.053.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.053.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_waldensian_spiritual_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.053.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.053.b.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:waldensian_priest's preference.
						## Spiritual + Hof.
						if = {
							limit = { scope:waldensian_council_stance_clergy = flag:waldensian_council_stance_hof }
							bryten_heresy_council_waldensian_hof_effect = yes
						}
						## Lay Clergy.
						if = {
							limit = { scope:waldensian_council_stance_clergy = flag:waldensian_council_stance_lay_clergy }
							bryten_heresy_council_waldensian_lay_priests_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 0
		}
	}
	option = {# Lay Clergy
		name = bryten_heresy.053.c
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:waldensian_council_stance_clergy = flag:waldensian_council_stance_lay_clergy	}
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_waldensian_lay_priests_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.053.c.tt.success
					send_interface_toast = {
						title = bryten_heresy.053.c.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_waldensian_lay_priests_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.053.c.tt.failure
					send_interface_toast = {
						title = bryten_heresy.053.c.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:waldensian_priest's preference.
						## Spiritual + Hof.
						if = {
							limit = { scope:waldensian_council_stance_clergy = flag:waldensian_council_stance_hof }
							bryten_heresy_council_waldensian_hof_effect = yes
						}
						## Spiritual.
						if = {
							limit = { scope:waldensian_council_stance_clergy = flag:waldensian_council_stance_spiritual }
							bryten_heresy_council_waldensian_spiritual_effect = yes
						}
					}
				}
			}
		}

		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 0
		}
	}
	option = {# I have no opinion on this matter.
		name = bryten_heresy.053.d

		# We take scope:waldensian_priest's preference.
		## Spiritual + Hof.
		if = {
			limit = { scope:waldensian_council_stance_clergy = flag:waldensian_council_stance_hof }
			bryten_heresy_council_waldensian_hof_effect = yes
		}
		## Spiritual.
		if = {
			limit = { scope:waldensian_council_stance_clergy = flag:waldensian_council_stance_spiritual }
			bryten_heresy_council_waldensian_spiritual_effect = yes
		}
		## Lay Clergy.
		if = {
			limit = { scope:waldensian_council_stance_clergy = flag:waldensian_council_stance_lay_clergy }
			bryten_heresy_council_waldensian_lay_priests_effect = yes
		}

		# We don't charge stress for the opt-outs, not least because their results are variable.
		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.054
			days = {5 10}
		}
	}
}
# Council: Female Clergy
scripted_effect bryten_heresy_council_waldensian_no_women = {
	faith:waldensian = { 
		add_doctrine = doctrine_clerical_gender_male_only
	}
}
scripted_effect bryten_heresy_council_waldensian_yes_women = {
	faith:waldensian = { 
		hidden_effect = { remove_doctrine = doctrine_clerical_gender_male_only }
		add_doctrine = doctrine_clerical_gender_either 
	}
}
bryten_heresy.054 = {# Council: Female Clergy
	type = character_event
	title = bryten_heresy.054.t
	desc = bryten_heresy.054.desc
	theme = martial
	left_portrait = {
		character = scope:waldensian_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:waldensian_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:waldensian_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:waldensian_priest_at_council }
			clear_saved_scope = waldensian_priest_at_council
		}
		## Now try to refresh it.
		scope:waldensian_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = waldensian_priest_at_council
			}
		}
	}

	option = {# No female
		name = bryten_heresy.054.a
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted } 
				NOT = {	scope:waldensian_council_stance_female = flag:waldensian_council_stance_no_female_clergy }
			}
		}


		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_waldensian_no_women = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.054.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.054.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_waldensian_no_women = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.054.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.054.a.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_waldensian_yes_women = yes
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 0
		}
	}
	option = {# Female clergy
		name = bryten_heresy.054.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted } 
				NOT = {	scope:waldensian_council_stance_female = flag:waldensian_council_stance_yes_female_clergy }
			}
		}
		if = {# going against Peter Waldo himself is costly
				limit = { scope:waldensian_priest = { has_character_flag = waldensian_priest_is_peter }
			}
			add_piety = {
				value = bryten_waldensian_council_oppose_peter_waldo_cost_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_waldensian_yes_women = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.054.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.054.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_waldensian_yes_women = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.054.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.054.b.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_waldensian_no_women = yes
					}
				}
			}
		}

		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 0
		}
	}
	option = {# The clergy decide
		name = bryten_heresy.054.d

		# We take scope:waldensian_priest's preference.
		## No Female Clergy.
		if = {
			limit = { scope:waldensian_council_stance_female = flag:waldensian_council_stance_no_female_clergy }
			bryten_heresy_council_waldensian_no_women = yes
		}
		## Allow Female Clergy.
		if = {
			limit = { scope:waldensian_council_stance_female = flag:waldensian_council_stance_yes_female_clergy }
			bryten_heresy_council_waldensian_yes_women = yes
		}
		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.055
			days = {5 10}
		}
	}
}
# Council: Divorce
scripted_effect bryten_heresy_council_waldensian_no_divorce = {
	faith:waldensian = { 
		add_doctrine = doctrine_divorce_disallowed }
}
scripted_effect bryten_heresy_council_waldensian_approve_divorce = {
	faith:waldensian = { 
		add_doctrine = doctrine_divorce_approval 
	}
}
bryten_heresy.055 = {# Council: Divorce
	type = character_event
	title = bryten_heresy.055.t
	desc = bryten_heresy.055.desc
	theme = martial
	left_portrait = {
		character = scope:waldensian_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:waldensian_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:waldensian_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:waldensian_priest_at_council }
			clear_saved_scope = waldensian_priest_at_council
		}
		## Now try to refresh it.
		scope:waldensian_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = waldensian_priest_at_council
			}
		}
	}

	option = {# No Divorce
		name = bryten_heresy.055.a
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:waldensian_council_stance_divorce = flag:waldensian_council_stance_no_divorce	}
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_waldensian_no_divorce = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.055.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.055.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_waldensian_no_divorce = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.055.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.055.a.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_waldensian_approve_divorce = yes

					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 0
		}
	}
	option = {# Allow Divorce
		name = bryten_heresy.055.b
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:waldensian_council_stance_divorce = flag:waldensian_council_stance_yes_divorce }
			}
		}
		if = {# going against Peter Waldo himself is costly
				limit = { scope:waldensian_priest = { has_character_flag = waldensian_priest_is_peter }
			}
			add_piety = {
				value = bryten_waldensian_council_oppose_peter_waldo_cost_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_waldensian_approve_divorce = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.055.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.055.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_waldensian_approve_divorce = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.055.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.055.b.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_waldensian_no_divorce = yes

					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 0
		}
	}
	option = {# The Clergy decide
		name = bryten_heresy.055.d

		# We take scope:waldensian_priest's preference.
		if = {# No Divorce
			limit = { scope:waldensian_council_stance_divorce = flag:waldensian_council_stance_no_divorce }
			bryten_heresy_council_waldensian_no_divorce = yes
		}
		if = {# Allow Divorce
			limit = { scope:waldensian_council_stance_divorce = flag:waldensian_council_stance_yes_divorce }
			bryten_heresy_council_waldensian_approve_divorce = yes
		}

		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 100
		}
	}
	
	after = {
		trigger_event = {
			id = bryten_heresy.056
			days = { 5 10 }
		}
	}

}
# Council: Pilgrimage
scripted_effect bryten_heresy_council_waldensian_no_pilgrimage = {
	faith:waldensian = { 
		add_doctrine = doctrine_pilgrimage_forbidden 
	}
}
scripted_effect bryten_heresy_council_waldensian_yes_pilgrimage = {
	faith:waldensian = { 
		hidden_effect = { remove_doctrine = doctrine_pilgrimage_forbidden }
		add_doctrine = doctrine_pilgrimage_encouraged 
	}
}
bryten_heresy.056 = {# Council: Pilgrimage
	type = character_event
	title = bryten_heresy.056.t
	desc = bryten_heresy.056.desc
	theme = martial
	left_portrait = {
		character = scope:waldensian_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:waldensian_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:waldensian_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:waldensian_priest_at_council }
			clear_saved_scope = waldensian_priest_at_council
		}
		## Now try to refresh it.
		scope:waldensian_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = waldensian_priest_at_council
			}
		}
	}

	option = {# No Pilgrimage
		name = bryten_heresy.056.a
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:waldensian_council_stance_pilgrimage = flag:waldensian_council_stance_forbid_pilgriamge }
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_waldensian_no_pilgrimage = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.056.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.056.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_waldensian_no_pilgrimage = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.056.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.056.a.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_waldensian_yes_pilgrimage = yes
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 0
		}
	}
	option = {# Yes Pilgrimage
		name = bryten_heresy.056.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:waldensian_council_stance_pilgrimage = flag:waldensian_council_stance_allow_pilgrimage }
			}
		}
		if = {# going against Peter Waldo himself is costly
				limit = { scope:waldensian_priest = { has_character_flag = waldensian_priest_is_peter }
			}
			add_piety = {
				value = bryten_waldensian_council_oppose_peter_waldo_cost_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_waldensian_yes_pilgrimage = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.056.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.056.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_waldensian_yes_pilgrimage = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.056.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.056.b.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_waldensian_no_pilgrimage = yes

					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 0
		}
	}
	option = {# Clergy Decide
		name = bryten_heresy.056.d

		if = {# No Pilgrimages
			limit = { scope:waldensian_council_stance_pilgrimage = flag:waldensian_council_stance_forbid_pilgriamge }
			bryten_heresy_council_waldensian_no_pilgrimage = yes
		}
		if = {# Yes Pilgrimages
			limit = { scope:waldensian_council_stance_pilgrimage = flag:waldensian_council_stance_allow_pilgrimage }
			bryten_heresy_council_waldensian_yes_pilgrimage = yes
		}
		ai_chance = {
			# The AI should just let the scope:waldensian_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.057
			days = {5 10}
		}
	}
}
# council results
bryten_heresy.057 = {# The church council arrives at their final important doctrinal conclusions.
	type = character_event
	title = bryten_heresy.057.t
	desc = {
		desc = bryten_heresy.057.desc.intro
		first_valid = {# Priesthood
			triggered_desc = {# Spiritual + Hof
				trigger = {	faith:waldensian = { has_doctrine = doctrine_spiritual_head } }
				desc = bryten_heresy.057.desc.hof
			}
			triggered_desc = {# Spiritual 
				trigger = {
					faith:waldensian = { 
						NOT = {	has_doctrine = doctrine_spiritual_head }
						has_doctrine = doctrine_theocracy_temporal 
					}
				}
				desc = bryten_heresy.057.desc.priests
			}
			triggered_desc = {# Lay Clergy
				trigger = {	faith:waldensian = { has_doctrine = doctrine_theocracy_lay_clergy }	}
				desc = bryten_heresy.057.desc.lay
			}
		}
		first_valid = {# female clergy
			triggered_desc = {# No Female Clergy
				trigger = {	faith:waldensian = { has_doctrine = doctrine_clerical_gender_male_only } }
				desc = bryten_heresy.057.desc.male_only
			}
			triggered_desc = {# Yes Female Clergy
				trigger = {	faith:waldensian = { has_doctrine = doctrine_clerical_gender_either }	}
				desc = bryten_heresy.057.desc.female_clergy
			}
		}
		first_valid = {# Divorce
			triggered_desc = {# No Divorce
				trigger = {	faith:waldensian = { has_doctrine = doctrine_divorce_disallowed } }
				desc = bryten_heresy.057.desc.divorce_banned
			}
			triggered_desc = {# Yes Divorce
				trigger = {	faith:waldensian = { has_doctrine = doctrine_divorce_approval } }
				desc = bryten_heresy.057.desc.divorce_allowed
			}
		}
		first_valid = {# Pilgrimage
			triggered_desc = {# No Pilgrimage
				trigger = {	faith:waldensian = { has_doctrine = doctrine_pilgrimage_forbidden } }
				desc = bryten_heresy.057.desc.pilgrimage_forbidden
			}
			triggered_desc = {# Yes Pilgrimage
				trigger = {	faith:waldensian = { has_doctrine = doctrine_pilgrimage_encouraged } }
				desc = bryten_heresy.057.desc.pilgrimage_allowed
			}
		}
		# Outro.
		desc = bryten_heresy.057.desc.outro
	}
	theme = faith
	left_portrait = {
		character = scope:waldensian_council_host
		animation = personality_bold
	}
	right_portrait = {
		character = scope:waldensian_priest_at_council
		animation = chancellor
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Music!
		play_music_cue = "mx_cue_sacredrite"
		faith:waldensian = {# the Council is over and now is formulized
			remove_doctrine = heretic_movement_doctrine
			change_fervor = { 
				value = 50
				desc = bryten_fervor_gain_waldensian_council	
			} 
		}
		# Now let's display our choices.
		faith:waldensian = {
			show_as_tooltip = {
				# Gnosticism.
				if = {
					limit = { has_doctrine = doctrine_pluralism_righteous }
					add_doctrine = doctrine_pluralism_righteous
				}
				if = {
					limit = { has_doctrine = doctrine_pluralism_righteous }
					add_doctrine = doctrine_pluralism_righteous
				}
				if = {
					limit = { has_doctrine = doctrine_pluralism_pluralistic }
					add_doctrine = doctrine_pluralism_pluralistic
				}
				# Priesthood.
				if = {
					limit = { has_doctrine = doctrine_spiritual_head }
					add_doctrine = doctrine_theocracy_temporal
					add_doctrine = doctrine_spiritual_head
				}
				if = {
					limit = { 
						has_doctrine = doctrine_theocracy_temporal 
						NOT = { has_doctrine = doctrine_spiritual_head }
					}
					add_doctrine = doctrine_theocracy_temporal
				}
				if = {
					limit = { has_doctrine = doctrine_theocracy_lay_clergy }
					add_doctrine = doctrine_theocracy_lay_clergy
				}
				# Wealth.
				if = {
					limit = { has_doctrine = tenet_communal_possessions }
					add_doctrine = tenet_communal_possessions
				}
				if = {
					limit = { has_doctrine = tenet_apostolic_poverty }
					add_doctrine = tenet_apostolic_poverty
				}
				if = {
					limit = { has_doctrine = tenet_pure_priesthood }
					add_doctrine = tenet_pure_priesthood
				}
				# Pacifism.
				if = {
					limit = { has_doctrine = tenet_armed_pilgrimages }
					add_doctrine = tenet_armed_pilgrimages
				}
				if = {
					limit = { has_doctrine = tenet_pacifism }
					add_doctrine = tenet_pacifism
				}
				if = {
					limit = { has_doctrine = tenet_unrelenting_faith }
					add_doctrine = tenet_unrelenting_faith
				}
			}


		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:bryten_waldensian_council_completed
		}


	}

	option = {
		name = bryten_heresy.057.a
		add_piety = major_piety_gain

	}

	after = {
		# Clean up the story.
		every_player = {# letting players know that the waldensian church has been formalized
			trigger_event = {
				id = bryten_heresy.058
				days = {5 10}
			}
		}
	}
}
bryten_heresy.058 = {# waldensian Council(let players know)
	type = character_event
	title = bryten_heresy.058.t
	desc = bryten_heresy.058.desc
	theme = faith	


	option = {# Condemn the heretic
		name = bryten_heresy.058.a
	}
}
#######################################
# lollard 
#######################################
bryten_heresy.075 = {# John Wycliff begins preaching
	hidden = yes

	immediate = {
		random_county_in_region = {
			region = custom_lollard_region
			save_scope_as = lollardy_county
		}
		create_character = {# Bogomil
			name = "John"
			gender = male
			location = scope:lollardy_county.title_province
			age = 30
			faith = faith:lollard
			culture = culture:english
			trait = heresiarch
			trait = generous
			trait = theologian
			trait = education_learning_4
			save_scope_as = lollard_founder
		}
		set_global_variable = {
			name = lollard_spawned
			value = yes
		}
		# Unlock Lollardy to convert to and be a heresy more generally
		faith:lollard = { remove_doctrine = unavailable_doctrine }
		every_county_in_region = {# Convert counties in the Balkans from Orthodoxy to Bogomilism
			region = custom_lollard_region
			limit = {# this should only apply to Ecumenical faiths, ie catholic and Orthodox mainly.
				faith = {
					has_doctrine = special_doctrine_ecumenical_christian
				}
			}
			random = {
				chance = 5
				set_county_faith = faith:lollard
				add_county_modifier = {
					modifier = rebellious_people
					years = 10
				}
			}
		}
		every_ruler = {# give people the ability to convert
			limit = { capital_province = { geographical_region = custom_lollard_region } }
			trigger_event = {
				id = bryten_heresy.076
				days = { 30 50 }
			}
		}
		
	}
}
bryten_heresy.076 = {# Convert to lollard?
	type = character_event
	title = bryten_heresy.076.t
	desc = bryten_heresy.076.desc
	theme = faith
	
	
	left_portrait = {
		character = root
		animation = personality_zealous
	}
	
	immediate = {

	}

	option = {# Condemn the heretics
		name = bryten_heresy.076.a
		ai_chance = { base = 89	}
		every_vassal = {# Zealous Vassals love it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = approves_heretic_condemnation
				target = root
				opinion = 40
			}
		}
	}
	option = {# Let him preach
		name = bryten_heresy.076.b
		ai_chance = { base = 20	} # rare 
		every_vassal = {# Zealous Vassals hate it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = disapproves_heretic_toleration
				target = root
				opinion = -40
			}
		}
		every_held_title = {# lollard counties are really happy
			limit = {
				tier = tier_county
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}	
		hidden_effect = {
			random = {# convert more areas to lollard
				chance = 5
				every_held_title = {
					limit = {
						tier = tier_county
						NOT = { faith = faith:lollard }
						faith = {# this is to ensure its a reaction to catholicism not any other heretical movement
							has_doctrine = special_doctrine_ecumenical_christian
						}
					}
					set_county_faith = faith:lollard
				}
			}			
		}

	}
	option = {# he is interesting ideas
		name = bryten_heresy.076.c
		ai_chance = { base = 01	} # super rare mainly for players
		faith:lollard = { 
			change_fervor = { 
				value = 5	
				desc = bryten_fervor_gain_heretical_lord
			} 
		}
		set_character_faith = faith:lollard
		every_held_title = {# lollard counties are really happy
			limit = {
				tier = tier_county
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}
	}	
}
# Council: Council gathers from all over
bryten_heresy.077 = {# council: Clergy gather from all over
	type = character_event
	title = bryten_heresy.077.t
	desc = bryten_heresy.077.desc
	theme = learning
	left_portrait = {
		character = scope:lollard_council_host
		animation = personality_rational
	}
	right_portrait = {
		character = scope:lollard_priest_at_council
		animation = chancellor
	}
	override_background = { reference = temple_scope }

	immediate = {
		# You are a heresiarch
		add_trait = heresiarch
		# Sort our locale.
		## First, whether this is a repeater.
		scope:council_1_venue = {
			## Preferring to chill at scope:lollard_priest's place.
			if = {
				limit = { holder = scope:lollard_priest }
				save_scope_as = council_2_venue
			}
			## But otherwise we take your capital.
			else = {
				scope:lollard_council_host.capital_barony = { save_scope_as = council_2_venue }
			}
		}
		scope:council_2_venue = { save_scope_as = background_temple_scope }
		scope:lollard_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = lollard_priest_at_council
			}
		}
	}

	
	option = {# Naturally, I'll take a leading role in the discussions.
		name = bryten_heresy.077.a

		# You'll engage in learning debates.
		custom_tooltip = bryten_heresy.077.a.tt
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:debate
		}
		stress_impact = {
			gregarious = miniscule_stress_impact_loss
			shy = medium_stress_impact_gain
		}
		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 0
		}
	}
	option = {# My influence will be more felt than seen...
		name = bryten_heresy.077.b
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:piety
		}
		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 0
		}
	}
	option = {# This is a matter for the clergy alone.
		name = bryten_heresy.077.c
		custom_tooltip = bryten_heresy.077.c.tt
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:defaulted
		}
		stress_impact = {
			humble = miniscule_stress_impact_loss
			arrogant = major_stress_impact_gain
		}
		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 100
		}
	}


	after = {
		trigger_event = {
			id = bryten_heresy.078
			days = {5 10}
		}
	}
}
# Council: The priesthood
scripted_effect bryten_heresy_council_lollard_hof_effect = {
	faith:lollard = { 
		hidden_effect = { remove_doctrine = doctrine_theocracy_lay_clergy }
		add_doctrine = doctrine_theocracy_temporal
		add_doctrine = doctrine_spiritual_head
		set_up_dynamic_spiritual_hof_title_effect = { CREATOR = scope:lollard_council_host }
	}
}
scripted_effect bryten_heresy_council_lollard_spiritual_effect = {
	faith:lollard = { 
		hidden_effect = { remove_doctrine = doctrine_theocracy_lay_clergy }
		add_doctrine = doctrine_theocracy_temporal 
	}
}
scripted_effect bryten_heresy_council_lollard_lay_priests_effect = {
	faith:lollard = { 
		add_doctrine = doctrine_theocracy_lay_clergy 
	}
}
bryten_heresy.078 = {# Council: priesthood
	type = character_event
	title = bryten_heresy.078.t
	desc = bryten_heresy.078.desc
	theme = diplomacy
	left_portrait = {
		character = scope:lollard_council_host
		animation = personality_bold
	}
	right_portrait = {
		character = scope:lollard_priest_at_council
		animation = personality_bold
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:lollard_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:lollard_priest_at_council }
			clear_saved_scope = lollard_priest_at_council
		}
		## Now try to refresh it.
		scope:lollard_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = lollard_priest_at_council
			}
		}
	}

	option = {# Spiritual + Hof
		name = bryten_heresy.078.a
		trigger = { 
			OR = {
				not = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:lollard_council_stance_clergy = flag:lollard_council_stance_hof	}
			}
		}
		if = {# going against John Wycliff himself is costly
				limit = { scope:lollard_priest = { has_character_flag = lollard_priest_is_wycliff }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_lollard_hof_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.078.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.078.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_lollard_hof_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.078.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.078.a.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:lollard_priest's preference.
						## Spiritual.
						if = {
							limit = { scope:lollard_council_stance_clergy = flag:lollard_council_stance_spiritual }
							bryten_heresy_council_lollard_spiritual_effect = yes
						}
						## Lay Clergy.
						if = {
							limit = { scope:lollard_council_stance_clergy = flag:lollard_council_stance_lay_clergy }
							bryten_heresy_council_lollard_lay_priests_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 0
		}
	}
	option = {# Spiritual
		name = bryten_heresy.078.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:lollard_council_stance_clergy = flag:lollard_council_stance_spiritual }
			}
		}

		if = {# going against John Wycliff himself is costly
				limit = { scope:lollard_priest = { has_character_flag = lollard_priest_is_wycliff }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		if = {# Piety path.
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_lollard_spiritual_effect = yes
		}
		if = {# Debate path.
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.078.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.078.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_lollard_spiritual_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.078.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.078.b.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:lollard_priest's preference.
						## Spiritual + Hof.
						if = {
							limit = { scope:lollard_council_stance_clergy = flag:lollard_council_stance_hof }
							bryten_heresy_council_lollard_hof_effect = yes
						}
						## Lay Clergy.
						if = {
							limit = { scope:lollard_council_stance_clergy = flag:lollard_council_stance_lay_clergy }
							bryten_heresy_council_lollard_lay_priests_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 0
		}
	}
	option = {# Lay Clergy
		name = bryten_heresy.078.c
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:lollard_council_stance_clergy = flag:lollard_council_stance_lay_clergy	}
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_lollard_lay_priests_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.078.c.tt.success
					send_interface_toast = {
						title = bryten_heresy.078.c.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_lollard_lay_priests_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.078.c.tt.failure
					send_interface_toast = {
						title = bryten_heresy.078.c.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:lollard_priest's preference.
						## Spiritual + Hof.
						if = {
							limit = { scope:lollard_council_stance_clergy = flag:lollard_council_stance_hof }
							bryten_heresy_council_lollard_hof_effect = yes
						}
						## Spiritual.
						if = {
							limit = { scope:lollard_council_stance_clergy = flag:lollard_council_stance_spiritual }
							bryten_heresy_council_lollard_spiritual_effect = yes
						}
					}
				}
			}
		}

		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 0
		}
	}
	option = {# I have no opinion on this matter.
		name = bryten_heresy.078.d

		# We take scope:lollard_priest's preference.
		## Spiritual + Hof.
		if = {
			limit = { scope:lollard_council_stance_clergy = flag:lollard_council_stance_hof }
			bryten_heresy_council_lollard_hof_effect = yes
		}
		## Spiritual.
		if = {
			limit = { scope:lollard_council_stance_clergy = flag:lollard_council_stance_spiritual }
			bryten_heresy_council_lollard_spiritual_effect = yes
		}
		## Lay Clergy.
		if = {
			limit = { scope:lollard_council_stance_clergy = flag:lollard_council_stance_lay_clergy }
			bryten_heresy_council_lollard_lay_priests_effect = yes
		}

		# We don't charge stress for the opt-outs, not least because their results are variable.
		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.079
			days = {5 10}
		}
	}
}
# Council: Female Clergy
scripted_effect bryten_heresy_council_lollard_no_women = {
	faith:lollard = { 
		add_doctrine = doctrine_clerical_gender_male_only
	}
}
scripted_effect bryten_heresy_council_lollard_yes_women = {
	faith:lollard = { 
		hidden_effect = { remove_doctrine = doctrine_clerical_gender_male_only }
		add_doctrine = doctrine_clerical_gender_either 
	}
}
bryten_heresy.079 = {# Council: Female Clergy
	type = character_event
	title = bryten_heresy.079.t
	desc = bryten_heresy.079.desc
	theme = martial
	left_portrait = {
		character = scope:lollard_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:lollard_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:lollard_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:lollard_priest_at_council }
			clear_saved_scope = lollard_priest_at_council
		}
		## Now try to refresh it.
		scope:lollard_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = lollard_priest_at_council
			}
		}
	}

	option = {# No female
		name = bryten_heresy.079.a
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted } 
				NOT = {	scope:lollard_council_stance_female = flag:lollard_council_stance_no_female_clergy }
			}
		}


		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_lollard_no_women = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.079.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.079.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_lollard_no_women = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.079.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.079.a.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_lollard_yes_women = yes
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 0
		}
	}
	option = {# Female clergy
		name = bryten_heresy.079.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted } 
				NOT = {	scope:lollard_council_stance_female = flag:lollard_council_stance_yes_female_clergy }
			}
		}
		if = {# going against John Wycliff himself is costly
				limit = { scope:lollard_priest = { has_character_flag = lollard_priest_is_wycliff }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_lollard_yes_women = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.079.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.079.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_lollard_yes_women = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.079.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.079.b.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_lollard_no_women = yes
					}
				}
			}
		}

		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 0
		}
	}
	option = {# The clergy decide
		name = bryten_heresy.079.d

		# We take scope:lollard_priest's preference.
		## No Female Clergy.
		if = {
			limit = { scope:lollard_council_stance_female = flag:lollard_council_stance_no_female_clergy }
			bryten_heresy_council_lollard_no_women = yes
		}
		## Allow Female Clergy.
		if = {
			limit = { scope:lollard_council_stance_female = flag:lollard_council_stance_yes_female_clergy }
			bryten_heresy_council_lollard_yes_women = yes
		}
		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.080
			days = {5 10}
		}
	}
}
# Council: Divorce
scripted_effect bryten_heresy_council_lollard_no_divorce = {
	faith:lollard = { 
		add_doctrine = doctrine_divorce_disallowed }
}
scripted_effect bryten_heresy_council_lollard_approve_divorce = {
	faith:lollard = { 
		add_doctrine = doctrine_divorce_approval 
	}
}
bryten_heresy.080 = {# Council: Divorce
	type = character_event
	title = bryten_heresy.080.t
	desc = bryten_heresy.080.desc
	theme = martial
	left_portrait = {
		character = scope:lollard_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:lollard_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:lollard_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:lollard_priest_at_council }
			clear_saved_scope = lollard_priest_at_council
		}
		## Now try to refresh it.
		scope:lollard_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = lollard_priest_at_council
			}
		}
	}

	option = {# No Divorce
		name = bryten_heresy.080.a
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:lollard_council_stance_divorce = flag:lollard_council_stance_no_divorce	}
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_lollard_no_divorce = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.080.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.080.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_lollard_no_divorce = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.080.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.080.a.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_lollard_approve_divorce = yes

					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 0
		}
	}
	option = {# Allow Divorce
		name = bryten_heresy.080.b
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:lollard_council_stance_divorce = flag:lollard_council_stance_yes_divorce }
			}
		}
		if = {# going against John Wycliff himself is costly
				limit = { scope:lollard_priest = { has_character_flag = lollard_priest_is_wycliff }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_lollard_approve_divorce = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.080.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.080.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_lollard_approve_divorce = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.080.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.080.b.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_lollard_no_divorce = yes

					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 0
		}
	}
	option = {# The Clergy decide
		name = bryten_heresy.080.d

		# We take scope:lollard_priest's preference.
		if = {# No Divorce
			limit = { scope:lollard_council_stance_divorce = flag:lollard_council_stance_no_divorce }
			bryten_heresy_council_lollard_no_divorce = yes
		}
		if = {# Allow Divorce
			limit = { scope:lollard_council_stance_divorce = flag:lollard_council_stance_yes_divorce }
			bryten_heresy_council_lollard_approve_divorce = yes
		}

		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 100
		}
	}
	
	after = {
		trigger_event = {
			id = bryten_heresy.081
			days = { 5 10 }
		}
	}

}
# Council: Pilgrimage
scripted_effect bryten_heresy_council_lollard_no_pilgrimage = {
	faith:lollard = { 
		add_doctrine = doctrine_pilgrimage_forbidden 
	}
}
scripted_effect bryten_heresy_council_lollard_yes_pilgrimage = {
	faith:lollard = { 
		hidden_effect = { remove_doctrine = doctrine_pilgrimage_forbidden }
		add_doctrine = doctrine_pilgrimage_encouraged 
	}
}
bryten_heresy.081 = {# Council: Pilgrimage
	type = character_event
	title = bryten_heresy.081.t
	desc = bryten_heresy.081.desc
	theme = martial
	left_portrait = {
		character = scope:lollard_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:lollard_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:lollard_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:lollard_priest_at_council }
			clear_saved_scope = lollard_priest_at_council
		}
		## Now try to refresh it.
		scope:lollard_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = lollard_priest_at_council
			}
		}
	}

	option = {# No Pilgrimage
		name = bryten_heresy.081.a
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:lollard_council_stance_pilgrimage = flag:lollard_council_stance_forbid_pilgriamge }
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_lollard_no_pilgrimage = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.081.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.081.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_lollard_no_pilgrimage = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.081.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.081.a.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_lollard_yes_pilgrimage = yes
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 0
		}
	}
	option = {# Yes Pilgrimage
		name = bryten_heresy.081.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:lollard_council_stance_pilgrimage = flag:lollard_council_stance_allow_pilgrimage }
			}
		}
		if = {# going against John Wycliff himself is costly
				limit = { scope:lollard_priest = { has_character_flag = lollard_priest_is_wycliff }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_lollard_yes_pilgrimage = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.081.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.081.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_lollard_yes_pilgrimage = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.081.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.081.b.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_lollard_no_pilgrimage = yes

					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 0
		}
	}
	option = {# Clergy Decide
		name = bryten_heresy.081.d

		if = {# No Pilgrimages
			limit = { scope:lollard_council_stance_pilgrimage = flag:lollard_council_stance_forbid_pilgriamge }
			bryten_heresy_council_lollard_no_pilgrimage = yes
		}
		if = {# Yes Pilgrimages
			limit = { scope:lollard_council_stance_pilgrimage = flag:lollard_council_stance_allow_pilgrimage }
			bryten_heresy_council_lollard_yes_pilgrimage = yes
		}
		ai_chance = {
			# The AI should just let the scope:lollard_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.082
			days = {5 10}
		}
	}
}
# council results
bryten_heresy.082 = {# The church council arrives at their final important doctrinal conclusions.
	type = character_event
	title = bryten_heresy.082.t
	desc = {
		desc = bryten_heresy.082.desc.intro
		first_valid = {# Priesthood
			triggered_desc = {# Spiritual + Hof
				trigger = {	faith:lollard = { has_doctrine = doctrine_spiritual_head } }
				desc = bryten_heresy.082.desc.hof
			}
			triggered_desc = {# Spiritual 
				trigger = {
					faith:lollard = { 
						NOT = {	has_doctrine = doctrine_spiritual_head }
						has_doctrine = doctrine_theocracy_temporal 
					}
				}
				desc = bryten_heresy.082.desc.priests
			}
			triggered_desc = {# Lay Clergy
				trigger = {	faith:lollard = { has_doctrine = doctrine_theocracy_lay_clergy }	}
				desc = bryten_heresy.082.desc.lay
			}
		}
		first_valid = {# female clergy
			triggered_desc = {# No Female Clergy
				trigger = {	faith:lollard = { has_doctrine = doctrine_clerical_gender_male_only } }
				desc = bryten_heresy.082.desc.male_only
			}
			triggered_desc = {# Yes Female Clergy
				trigger = {	faith:lollard = { has_doctrine = doctrine_clerical_gender_either }	}
				desc = bryten_heresy.082.desc.female_clergy
			}
		}
		first_valid = {# Divorce
			triggered_desc = {# No Divorce
				trigger = {	faith:lollard = { has_doctrine = doctrine_divorce_disallowed } }
				desc = bryten_heresy.082.desc.divorce_banned
			}
			triggered_desc = {# Yes Divorce
				trigger = {	faith:lollard = { has_doctrine = doctrine_divorce_approval } }
				desc = bryten_heresy.082.desc.divorce_allowed
			}
		}
		first_valid = {# Pilgrimage
			triggered_desc = {# No Pilgrimage
				trigger = {	faith:lollard = { has_doctrine = doctrine_pilgrimage_forbidden } }
				desc = bryten_heresy.082.desc.pilgrimage_forbidden
			}
			triggered_desc = {# Yes Pilgrimage
				trigger = {	faith:lollard = { has_doctrine = doctrine_pilgrimage_encouraged } }
				desc = bryten_heresy.082.desc.pilgrimage_allowed
			}
		}
		# Outro.
		desc = bryten_heresy.082.desc.outro
	}
	theme = faith
	left_portrait = {
		character = scope:lollard_council_host
		animation = personality_bold
	}
	right_portrait = {
		character = scope:lollard_priest_at_council
		animation = chancellor
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Music!
		play_music_cue = "mx_cue_sacredrite"
		faith:lollard = {# the Council is over and now is formulized
			remove_doctrine = heretic_movement_doctrine
			change_fervor = { 
				value = 50
				desc = bryten_fervor_gain_lollard_council	
			} 
		}
		# Now let's display our choices.
		faith:lollard = {
			show_as_tooltip = {
				# Gnosticism.
				if = {
					limit = { has_doctrine = doctrine_pluralism_righteous }
					add_doctrine = doctrine_pluralism_righteous
				}
				if = {
					limit = { has_doctrine = doctrine_pluralism_righteous }
					add_doctrine = doctrine_pluralism_righteous
				}
				if = {
					limit = { has_doctrine = doctrine_pluralism_pluralistic }
					add_doctrine = doctrine_pluralism_pluralistic
				}
				# Priesthood.
				if = {
					limit = { has_doctrine = doctrine_spiritual_head }
					add_doctrine = doctrine_theocracy_temporal
					add_doctrine = doctrine_spiritual_head
				}
				if = {
					limit = { 
						has_doctrine = doctrine_theocracy_temporal 
						NOT = { has_doctrine = doctrine_spiritual_head }
					}
					add_doctrine = doctrine_theocracy_temporal
				}
				if = {
					limit = { has_doctrine = doctrine_theocracy_lay_clergy }
					add_doctrine = doctrine_theocracy_lay_clergy
				}
				# Wealth.
				if = {
					limit = { has_doctrine = tenet_communal_possessions }
					add_doctrine = tenet_communal_possessions
				}
				if = {
					limit = { has_doctrine = tenet_apostolic_poverty }
					add_doctrine = tenet_apostolic_poverty
				}
				if = {
					limit = { has_doctrine = tenet_pure_priesthood }
					add_doctrine = tenet_pure_priesthood
				}
				# Pacifism.
				if = {
					limit = { has_doctrine = tenet_armed_pilgrimages }
					add_doctrine = tenet_armed_pilgrimages
				}
				if = {
					limit = { has_doctrine = tenet_pacifism }
					add_doctrine = tenet_pacifism
				}
				if = {
					limit = { has_doctrine = tenet_unrelenting_faith }
					add_doctrine = tenet_unrelenting_faith
				}
			}


		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:bryten_lollard_council_completed
		}


	}

	option = {
		name = bryten_heresy.082.a
		add_piety = major_piety_gain

	}

	after = {
		# Clean up the story.
		every_player = {# letting players know that the lollard church has been formalized
			trigger_event = {
				id = bryten_heresy.083
				days = {5 10}
			}
		}
	}
}
bryten_heresy.083 = {# lollard Council(let players know)
	type = character_event
	title = bryten_heresy.083.t
	desc = bryten_heresy.083.desc
	theme = faith	


	option = {# Condemn the heretic
		name = bryten_heresy.083.a
	}
}
#######################################
# arnoldism 
#######################################
bryten_heresy.100 = {# Arnold begins preaching
	hidden = yes

	immediate = {
		random_county_in_region = {
			region = custom_arnoldism_region
			save_scope_as = arnoldism_county
		}
		create_character = {# Arnold
			name = "Arnold"
			gender = male
			location = scope:arnoldism_county.title_province
			age = 30
			faith = faith:arnoldism
			culture = culture:occitan
			trait = heresiarch
			trait = generous
			trait = theologian
			trait = improvident
			trait = education_learning_4
			save_scope_as = arnoldism_founder
		}
		set_global_variable = {
			name = arnoldism_spawned
			value = yes
		}
		# Unlock Bogomilism to convert to and be a heresy more generally
		faith:arnoldism = { remove_doctrine = unavailable_doctrine }
		every_county_in_region = {# Convert counties in the Balkans from Orthodoxy to Bogomilism
			region = custom_arnoldism_region
			limit = {# this should only apply to Ecumenical faiths, ie catholic and Orthodox mainly.
				faith = {
					has_doctrine = special_doctrine_ecumenical_christian
				}
			}
			random = {
				chance = 5
				set_county_faith = faith:arnoldism
				add_county_modifier = {
					modifier = rebellious_people
					years = 10
				}
			}
		}
		every_ruler = {# give people the ability to convert
			limit = { capital_province = { geographical_region = custom_arnoldism_region } }
			trigger_event = {
				id = bryten_heresy.101
				days = { 30 50 }
			}
		}
		
	}
}
bryten_heresy.101 = {# Convert to arnoldism?
	type = character_event
	title = bryten_heresy.101.t
	desc = bryten_heresy.101.desc
	theme = faith
	
	
	left_portrait = {
		character = root
		animation = personality_zealous
	}
	
	immediate = {

	}

	option = {# Condemn the heretics
		name = bryten_heresy.101.a
		ai_chance = { base = 89	}
		every_vassal = {# Zealous Vassals love it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = approves_heretic_condemnation
				target = root
				opinion = 40
			}
		}
	}
	option = {# Let him preach
		name = bryten_heresy.101.b
		ai_chance = { base = 20	} # rare 
		every_vassal = {# Zealous Vassals hate it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = disapproves_heretic_toleration
				target = root
				opinion = -40
			}
		}
		every_held_title = {# lollard counties are really happy
			limit = {
				tier = tier_county
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}	
		hidden_effect = {
			random = {# convert more areas to arnoldism
				chance = 5
				every_held_title = {
					limit = {
						tier = tier_county
						NOT = { faith = faith:arnoldism }
						faith = {# this is to ensure its a reaction to catholicism not any other heretical movement
							has_doctrine = special_doctrine_ecumenical_christian
						}
					}
					set_county_faith = faith:arnoldism
				}
			}			
		}

	}
	option = {# he is interesting ideas
		name = bryten_heresy.101.c
		ai_chance = { base = 01	} # super rare mainly for players
		faith:arnoldism = { 
			change_fervor = { 
				value = 5	
				desc = bryten_fervor_gain_heretical_lord

			} 
		}
		set_character_faith = faith:arnoldism
		every_held_title = {# arnoldism counties are really happy
			limit = {
				tier = tier_county
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}
	}	
}
# Council: Council gathers from all over
bryten_heresy.102 = {# council: Clergy gather from all over
	type = character_event
	title = bryten_heresy.102.t
	desc = bryten_heresy.102.desc
	theme = learning
	left_portrait = {
		character = scope:arnoldism_council_host
		animation = personality_rational
	}
	right_portrait = {
		character = scope:arnoldism_priest_at_council
		animation = chancellor
	}
	override_background = { reference = temple_scope }

	immediate = {
		# You are a heresiarch
		add_trait = heresiarch
		# Sort our locale.
		## First, whether this is a repeater.
		scope:council_1_venue = {
			## Preferring to chill at scope:arnoldism_priest's place.
			if = {
				limit = { holder = scope:arnoldism_priest }
				save_scope_as = council_2_venue
			}
			## But otherwise we take your capital.
			else = {
				scope:arnoldism_council_host.capital_barony = { save_scope_as = council_2_venue }
			}
		}
		scope:council_2_venue = { save_scope_as = background_temple_scope }
		scope:arnoldism_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = arnoldism_priest_at_council
			}
		}
	}

	
	option = {# Naturally, I'll take a leading role in the discussions.
		name = bryten_heresy.102.a

		# You'll engage in learning debates.
		custom_tooltip = bryten_heresy.102.a.tt
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:debate
		}
		stress_impact = {
			gregarious = miniscule_stress_impact_loss
			shy = medium_stress_impact_gain
		}
		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 0
		}
	}
	option = {# My influence will be more felt than seen...
		name = bryten_heresy.102.b
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:piety
		}
		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 0
		}
	}
	option = {# This is a matter for the clergy alone.
		name = bryten_heresy.102.c
		custom_tooltip = bryten_heresy.102.c.tt
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:defaulted
		}
		stress_impact = {
			humble = miniscule_stress_impact_loss
			arrogant = major_stress_impact_gain
		}
		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 100
		}
	}


	after = {
		trigger_event = {
			id = bryten_heresy.103
			days = {5 10}
		}
	}
}
# Council: The priesthood
scripted_effect bryten_heresy_council_arnoldism_hof_effect = {
	faith:arnoldism = { 
		hidden_effect = { remove_doctrine = doctrine_theocracy_lay_clergy }
		add_doctrine = doctrine_theocracy_temporal
		add_doctrine = doctrine_spiritual_head
		set_up_dynamic_spiritual_hof_title_effect = { CREATOR = scope:arnoldism_council_host }
	}
}
scripted_effect bryten_heresy_council_arnoldism_spiritual_effect = {
	faith:arnoldism = { 
		hidden_effect = { remove_doctrine = doctrine_theocracy_lay_clergy }
		add_doctrine = doctrine_theocracy_temporal 
	}
}
scripted_effect bryten_heresy_council_arnoldism_lay_priests_effect = {
	faith:arnoldism = { 
		add_doctrine = doctrine_theocracy_lay_clergy 
	}
}
bryten_heresy.103 = {# Council: priesthood
	type = character_event
	title = bryten_heresy.103.t
	desc = bryten_heresy.103.desc
	theme = diplomacy
	left_portrait = {
		character = scope:arnoldism_council_host
		animation = personality_bold
	}
	right_portrait = {
		character = scope:arnoldism_priest_at_council
		animation = personality_bold
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:arnoldism_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:arnoldism_priest_at_council }
			clear_saved_scope = arnoldism_priest_at_council
		}
		## Now try to refresh it.
		scope:arnoldism_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = arnoldism_priest_at_council
			}
		}
	}

	option = {# Spiritual + Hof
		name = bryten_heresy.103.a
		trigger = { 
			OR = {
				not = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:arnoldism_council_stance_clergy = flag:arnoldism_council_stance_hof	}
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_arnoldism_hof_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.103.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.103.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_arnoldism_hof_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.103.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.103.a.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:arnoldism_priest's preference.
						## Spiritual.
						if = {
							limit = { scope:arnoldism_council_stance_clergy = flag:arnoldism_council_stance_spiritual }
							bryten_heresy_council_arnoldism_spiritual_effect = yes
						}
						## Lay Clergy.
						if = {
							limit = { scope:arnoldism_council_stance_clergy = flag:arnoldism_council_stance_lay_clergy }
							bryten_heresy_council_arnoldism_lay_priests_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 0
		}
	}
	option = {# Spiritual
		name = bryten_heresy.103.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:arnoldism_council_stance_clergy = flag:arnoldism_council_stance_spiritual }
			}
		}

		if = {# going against Arnold of Brescia himself is costly
				limit = { scope:arnoldism_priest = { has_character_flag = arnoldism_priest_is_arnold }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		if = {# Piety path.
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_arnoldism_spiritual_effect = yes
		}
		if = {# Debate path.
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.103.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.103.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_arnoldism_spiritual_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.103.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.103.b.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:arnoldism_priest's preference.
						## Spiritual + Hof.
						if = {
							limit = { scope:arnoldism_council_stance_clergy = flag:arnoldism_council_stance_hof }
							bryten_heresy_council_arnoldism_hof_effect = yes
						}
						## Lay Clergy.
						if = {
							limit = { scope:arnoldism_council_stance_clergy = flag:arnoldism_council_stance_lay_clergy }
							bryten_heresy_council_arnoldism_lay_priests_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 0
		}
	}
	option = {# Lay Clergy
		name = bryten_heresy.103.c
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:arnoldism_council_stance_clergy = flag:arnoldism_council_stance_lay_clergy	}
			}
		}
		if = {# going against Arnold of Brescia himself is costly
				limit = { scope:arnoldism_priest = { has_character_flag = arnoldism_priest_is_arnold }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_arnoldism_lay_priests_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.103.c.tt.success
					send_interface_toast = {
						title = bryten_heresy.103.c.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_arnoldism_lay_priests_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.103.c.tt.failure
					send_interface_toast = {
						title = bryten_heresy.103.c.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:arnoldism_priest's preference.
						## Spiritual + Hof.
						if = {
							limit = { scope:arnoldism_council_stance_clergy = flag:arnoldism_council_stance_hof }
							bryten_heresy_council_arnoldism_hof_effect = yes
						}
						## Spiritual.
						if = {
							limit = { scope:arnoldism_council_stance_clergy = flag:arnoldism_council_stance_spiritual }
							bryten_heresy_council_arnoldism_spiritual_effect = yes
						}
					}
				}
			}
		}

		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 0
		}
	}
	option = {# I have no opinion on this matter.
		name = bryten_heresy.103.d

		# We take scope:arnoldism_priest's preference.
		## Spiritual + Hof.
		if = {
			limit = { scope:arnoldism_council_stance_clergy = flag:arnoldism_council_stance_hof }
			bryten_heresy_council_arnoldism_hof_effect = yes
		}
		## Spiritual.
		if = {
			limit = { scope:arnoldism_council_stance_clergy = flag:arnoldism_council_stance_spiritual }
			bryten_heresy_council_arnoldism_spiritual_effect = yes
		}
		## Lay Clergy.
		if = {
			limit = { scope:arnoldism_council_stance_clergy = flag:arnoldism_council_stance_lay_clergy }
			bryten_heresy_council_arnoldism_lay_priests_effect = yes
		}

		# We don't charge stress for the opt-outs, not least because their results are variable.
		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.104
			days = {5 10}
		}
	}
}
# Council: Female Clergy
scripted_effect bryten_heresy_council_arnoldism_no_women = {
	faith:arnoldism = { 
		add_doctrine = doctrine_clerical_gender_male_only
	}
}
scripted_effect bryten_heresy_council_arnoldism_yes_women = {
	faith:arnoldism = { 
		hidden_effect = { remove_doctrine = doctrine_clerical_gender_male_only }
		add_doctrine = doctrine_clerical_gender_either 
	}
}
bryten_heresy.104 = {# Council: Female Clergy
	type = character_event
	title = bryten_heresy.104.t
	desc = bryten_heresy.104.desc
	theme = martial
	left_portrait = {
		character = scope:arnoldism_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:arnoldism_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:arnoldism_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:arnoldism_priest_at_council }
			clear_saved_scope = arnoldism_priest_at_council
		}
		## Now try to refresh it.
		scope:arnoldism_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = arnoldism_priest_at_council
			}
		}
	}

	option = {# No female
		name = bryten_heresy.104.a
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted } 
				NOT = {	scope:arnoldism_council_stance_female = flag:arnoldism_council_stance_no_female_clergy }
			}
		}


		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_arnoldism_no_women = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.104.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.104.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_arnoldism_no_women = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.104.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.104.a.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_arnoldism_yes_women = yes
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 0
		}
	}
	option = {# Female clergy
		name = bryten_heresy.104.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted } 
				NOT = {	scope:arnoldism_council_stance_female = flag:arnoldism_council_stance_yes_female_clergy }
			}
		}
		if = {# going against Arnold of Brescia himself is costly
				limit = { scope:arnoldism_priest = { has_character_flag = arnoldism_priest_is_arnold }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_arnoldism_yes_women = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.104.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.104.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_arnoldism_yes_women = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.104.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.104.b.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_arnoldism_no_women = yes
					}
				}
			}
		}

		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 0
		}
	}
	option = {# The clergy decide
		name = bryten_heresy.104.d

		# We take scope:arnoldism_priest's preference.
		## No Female Clergy.
		if = {
			limit = { scope:arnoldism_council_stance_female = flag:arnoldism_council_stance_no_female_clergy }
			bryten_heresy_council_arnoldism_no_women = yes
		}
		## Allow Female Clergy.
		if = {
			limit = { scope:arnoldism_council_stance_female = flag:arnoldism_council_stance_yes_female_clergy }
			bryten_heresy_council_arnoldism_yes_women = yes
		}
		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.105
			days = {5 10}
		}
	}
}
# Council: Divorce
scripted_effect bryten_heresy_council_arnoldism_no_divorce = {
	faith:arnoldism = { 
		add_doctrine = doctrine_divorce_disallowed }
}
scripted_effect bryten_heresy_council_arnoldism_approve_divorce = {
	faith:arnoldism = { 
		add_doctrine = doctrine_divorce_approval 
	}
}
bryten_heresy.105 = {# Council: Divorce
	type = character_event
	title = bryten_heresy.105.t
	desc = bryten_heresy.105.desc
	theme = martial
	left_portrait = {
		character = scope:arnoldism_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:arnoldism_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:arnoldism_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:arnoldism_priest_at_council }
			clear_saved_scope = arnoldism_priest_at_council
		}
		## Now try to refresh it.
		scope:arnoldism_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = arnoldism_priest_at_council
			}
		}
	}

	option = {# No Divorce
		name = bryten_heresy.105.a
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:arnoldism_council_stance_divorce = flag:arnoldism_council_stance_no_divorce	}
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_arnoldism_no_divorce = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.105.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.105.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_arnoldism_no_divorce = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.105.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.105.a.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_arnoldism_approve_divorce = yes

					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 0
		}
	}
	option = {# Allow Divorce
		name = bryten_heresy.105.b
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:arnoldism_council_stance_divorce = flag:arnoldism_council_stance_yes_divorce }
			}
		}
		if = {# going against Arnold of Brescia himself is costly
				limit = { scope:arnoldism_priest = { has_character_flag = arnoldism_priest_is_arnold }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_arnoldism_approve_divorce = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.105.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.105.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_arnoldism_approve_divorce = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.105.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.105.b.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_arnoldism_no_divorce = yes

					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 0
		}
	}
	option = {# The Clergy decide
		name = bryten_heresy.105.d

		# We take scope:arnoldism_priest's preference.
		if = {# No Divorce
			limit = { scope:arnoldism_council_stance_divorce = flag:arnoldism_council_stance_no_divorce }
			bryten_heresy_council_arnoldism_no_divorce = yes
		}
		if = {# Allow Divorce
			limit = { scope:arnoldism_council_stance_divorce = flag:arnoldism_council_stance_yes_divorce }
			bryten_heresy_council_arnoldism_approve_divorce = yes
		}

		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 100
		}
	}
	
	after = {
		trigger_event = {
			id = bryten_heresy.106
			days = { 5 10 }
		}
	}

}
# Council: Pilgrimage
scripted_effect bryten_heresy_council_arnoldism_no_pilgrimage = {
	faith:arnoldism = { 
		add_doctrine = doctrine_pilgrimage_forbidden 
	}
}
scripted_effect bryten_heresy_council_arnoldism_yes_pilgrimage = {
	faith:arnoldism = { 
		hidden_effect = { remove_doctrine = doctrine_pilgrimage_forbidden }
		add_doctrine = doctrine_pilgrimage_encouraged 
	}
}
bryten_heresy.106 = {# Council: Pilgrimage
	type = character_event
	title = bryten_heresy.106.t
	desc = bryten_heresy.106.desc
	theme = martial
	left_portrait = {
		character = scope:arnoldism_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:arnoldism_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:arnoldism_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:arnoldism_priest_at_council }
			clear_saved_scope = arnoldism_priest_at_council
		}
		## Now try to refresh it.
		scope:arnoldism_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = arnoldism_priest_at_council
			}
		}
	}

	option = {# No Pilgrimage
		name = bryten_heresy.106.a
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:arnoldism_council_stance_pilgrimage = flag:arnoldism_council_stance_forbid_pilgriamge }
			}
		}
		if = {# going against Arnold of Brescia himself is costly
				limit = { scope:arnoldism_priest = { has_character_flag = arnoldism_priest_is_arnold }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_arnoldism_no_pilgrimage = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.106.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.106.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_arnoldism_no_pilgrimage = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.106.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.106.a.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_arnoldism_yes_pilgrimage = yes
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 0
		}
	}
	option = {# Yes Pilgrimage
		name = bryten_heresy.106.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:arnoldism_council_stance_pilgrimage = flag:arnoldism_council_stance_allow_pilgrimage }
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_arnoldism_yes_pilgrimage = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.106.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.106.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_arnoldism_yes_pilgrimage = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.106.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.106.b.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_arnoldism_no_pilgrimage = yes

					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 0
		}
	}
	option = {# Clergy Decide
		name = bryten_heresy.106.d

		if = {# No Pilgrimages
			limit = { scope:arnoldism_council_stance_pilgrimage = flag:arnoldism_council_stance_forbid_pilgriamge }
			bryten_heresy_council_arnoldism_no_pilgrimage = yes
		}
		if = {# Yes Pilgrimages
			limit = { scope:arnoldism_council_stance_pilgrimage = flag:arnoldism_council_stance_allow_pilgrimage }
			bryten_heresy_council_arnoldism_yes_pilgrimage = yes
		}
		ai_chance = {
			# The AI should just let the scope:arnoldism_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.107
			days = {5 10}
		}
	}
}
# council results
bryten_heresy.107 = {# The church council arrives at their final important doctrinal conclusions.
	type = character_event
	title = bryten_heresy.107.t
	desc = {
		desc = bryten_heresy.107.desc.intro
		first_valid = {# Priesthood
			triggered_desc = {# Spiritual + Hof
				trigger = {	faith:arnoldism = { has_doctrine = doctrine_spiritual_head } }
				desc = bryten_heresy.107.desc.hof
			}
			triggered_desc = {# Spiritual 
				trigger = {
					faith:arnoldism = { 
						NOT = {	has_doctrine = doctrine_spiritual_head }
						has_doctrine = doctrine_theocracy_temporal 
					}
				}
				desc = bryten_heresy.107.desc.priests
			}
			triggered_desc = {# Lay Clergy
				trigger = {	faith:arnoldism = { has_doctrine = doctrine_theocracy_lay_clergy }	}
				desc = bryten_heresy.107.desc.lay
			}
		}
		first_valid = {# female clergy
			triggered_desc = {# No Female Clergy
				trigger = {	faith:arnoldism = { has_doctrine = doctrine_clerical_gender_male_only } }
				desc = bryten_heresy.107.desc.male_only
			}
			triggered_desc = {# Yes Female Clergy
				trigger = {	faith:arnoldism = { has_doctrine = doctrine_clerical_gender_either }	}
				desc = bryten_heresy.107.desc.female_clergy
			}
		}
		first_valid = {# Divorce
			triggered_desc = {# No Divorce
				trigger = {	faith:arnoldism = { has_doctrine = doctrine_divorce_disallowed } }
				desc = bryten_heresy.107.desc.divorce_banned
			}
			triggered_desc = {# Yes Divorce
				trigger = {	faith:arnoldism = { has_doctrine = doctrine_divorce_approval } }
				desc = bryten_heresy.107.desc.divorce_allowed
			}
		}
		first_valid = {# Pilgrimage
			triggered_desc = {# No Pilgrimage
				trigger = {	faith:arnoldism = { has_doctrine = doctrine_pilgrimage_forbidden } }
				desc = bryten_heresy.107.desc.pilgrimage_forbidden
			}
			triggered_desc = {# Yes Pilgrimage
				trigger = {	faith:arnoldism = { has_doctrine = doctrine_pilgrimage_encouraged } }
				desc = bryten_heresy.107.desc.pilgrimage_allowed
			}
		}
		# Outro.
		desc = bryten_heresy.107.desc.outro
	}
	theme = faith
	left_portrait = {
		character = scope:arnoldism_council_host
		animation = personality_bold
	}
	right_portrait = {
		character = scope:arnoldism_priest_at_council
		animation = chancellor
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Music!
		play_music_cue = "mx_cue_sacredrite"
		faith:arnoldism = {# the Council is over and now is formulized
			remove_doctrine = heretic_movement_doctrine
			change_fervor = { 
				value = 50
				desc = bryten_fervor_gain_arnoldism_council	
			} 
		}
		# Now let's display our choices.
		faith:arnoldism = {
			show_as_tooltip = {
				# Gnosticism.
				if = {
					limit = { has_doctrine = doctrine_pluralism_righteous }
					add_doctrine = doctrine_pluralism_righteous
				}
				if = {
					limit = { has_doctrine = doctrine_pluralism_righteous }
					add_doctrine = doctrine_pluralism_righteous
				}
				if = {
					limit = { has_doctrine = doctrine_pluralism_pluralistic }
					add_doctrine = doctrine_pluralism_pluralistic
				}
				# Priesthood.
				if = {
					limit = { has_doctrine = doctrine_spiritual_head }
					add_doctrine = doctrine_theocracy_temporal
					add_doctrine = doctrine_spiritual_head
				}
				if = {
					limit = { 
						has_doctrine = doctrine_theocracy_temporal 
						NOT = { has_doctrine = doctrine_spiritual_head }
					}
					add_doctrine = doctrine_theocracy_temporal
				}
				if = {
					limit = { has_doctrine = doctrine_theocracy_lay_clergy }
					add_doctrine = doctrine_theocracy_lay_clergy
				}
				# Wealth.
				if = {
					limit = { has_doctrine = tenet_communal_possessions }
					add_doctrine = tenet_communal_possessions
				}
				if = {
					limit = { has_doctrine = tenet_apostolic_poverty }
					add_doctrine = tenet_apostolic_poverty
				}
				if = {
					limit = { has_doctrine = tenet_pure_priesthood }
					add_doctrine = tenet_pure_priesthood
				}
				# Pacifism.
				if = {
					limit = { has_doctrine = tenet_armed_pilgrimages }
					add_doctrine = tenet_armed_pilgrimages
				}
				if = {
					limit = { has_doctrine = tenet_pacifism }
					add_doctrine = tenet_pacifism
				}
				if = {
					limit = { has_doctrine = tenet_unrelenting_faith }
					add_doctrine = tenet_unrelenting_faith
				}
			}


		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:bryten_arnoldism_council_completed
		}


	}

	option = {
		name = bryten_heresy.107.a
		add_piety = major_piety_gain

	}

	after = {
		# Clean up the story.
		every_player = {# letting players know that the arnoldism church has been formalized
			trigger_event = {
				id = bryten_heresy.108
				days = {5 10}
			}
		}
	}
}
bryten_heresy.108 = {# arnoldism Council(let players know)
	type = character_event
	title = bryten_heresy.108.t
	desc = bryten_heresy.108.desc
	theme = faith	


	option = {# Condemn the heretic
		name = bryten_heresy.108.a
	}
}
#######################################
# Fraticelli 
#######################################
bryten_heresy.150 = {# Fraticelli begins preaching
	hidden = yes

	immediate = {
		set_global_variable = {
			name = fraticelli_spawned
			value = yes
		}
		# Unlock Bogomilism to convert to and be a heresy more generally
		faith:fraticelli = { remove_doctrine = unavailable_doctrine }
		faith:fraticelli = { set_religious_head_title = title:k_papal_state }
		every_county_in_region = {# Convert counties in the Balkans from Orthodoxy to Bogomilism
			region = world_europe_south_italy
			limit = {# this should only apply to Ecumenical faiths, ie catholic and Orthodox mainly.
				faith = {
					has_doctrine = special_doctrine_ecumenical_christian
				}
			}
			random = {
				chance = 5
				set_county_faith = faith:fraticelli
				add_county_modifier = {
					modifier = rebellious_people
					years = 10
				}
			}
		}
		every_ruler = {# give people the ability to convert
			limit = { capital_province = { geographical_region = world_europe_south_italy } }
			trigger_event = {
				id = bryten_heresy.151
				days = { 30 50 }
			}
		}
		
	}
}
bryten_heresy.151 = {# Convert to fraticelli?
	type = character_event
	title = bryten_heresy.151.t
	desc = bryten_heresy.151.desc
	theme = faith
	
	
	left_portrait = {
		character = root
		animation = personality_zealous
	}
	
	immediate = {

	}

	option = {# Condemn the heretics
		name = bryten_heresy.151.a
		ai_chance = { base = 89	}
		every_vassal = {# Zealous Vassals love it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = approves_heretic_condemnation
				target = root
				opinion = 40
			}
		}
	}
	option = {# Let him preach
		name = bryten_heresy.151.b
		ai_chance = { base = 20	} # rare 
		every_vassal = {# Zealous Vassals hate it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = disapproves_heretic_toleration
				target = root
				opinion = -40
			}
		}
		every_held_title = {# fraticelli counties are really happy
			limit = {
				tier = tier_county
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}	
		hidden_effect = {
			random = {# convert more areas to fraticelli
				chance = 5
				every_held_title = {
					limit = {
						tier = tier_county
						NOT = { faith = faith:fraticelli }
						faith = {# this is to ensure its a reaction to catholicism not any other heretical movement
							has_doctrine = special_doctrine_ecumenical_christian
						}
					}
					set_county_faith = faith:fraticelli
				}
			}			
		}

	}
	option = {# he is interesting ideas
		name = bryten_heresy.151.c
		ai_chance = { base = 01	} # super rare mainly for players
		faith:fraticelli = { 
			change_fervor = { 
				value = 5	
				desc = bryten_fervor_gain_heretical_lord
			} 
		}
		set_character_faith = faith:fraticelli
		every_held_title = {# fraticelli counties are really happy
			limit = {
				tier = tier_county
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}
	}	
}
# Fraticelli Victory
bryten_heresy.152 = {# Catholicism is Fraticelli
	type = character_event
	title = bryten_heresy.152.t
	desc = bryten_heresy.152.desc
	theme = faith
	left_portrait = {
		character = scope:pope
		animation = personality_bold
	}

	immediate = {
		play_music_cue = "mx_cue_positive_effect"
		fraticelli_victory_decision_effects = yes
	}
	
	option = {# Glory be to God
		name = bryten_heresy.152.a
		give_nickname = nick_the_apostle
	}

	after = {
		hidden_effect = {
			every_player = {
				limit = { religion = religion:christianity_religion }
				trigger_event = { id = bryten_heresy.153 }
			}
		}
	}
}
bryten_heresy.153 = {# Fraticelli is victorious
	type = character_event
	title = bryten_heresy.153.t
	desc = bryten_heresy.153.desc
	theme = faith
	
	option = {
		name = name_i_see
	}
}
# Breaking with Rome
bryten_heresy.154 = {# Which Path to take
	type = character_event
	title = bryten_heresy.154.t
	desc = bryten_heresy.154.desc
	theme = faith
	
	
	left_portrait = {
		character = root
		animation = personality_zealous
	}
	
	immediate = { play_music_cue = "mx_cue_faith_conversion" }

	option = {# Support the Radicals - Heretical Path
		name = bryten_heresy.154.a
		hidden_effect = {
			trigger_event = {
				id = bryten_heresy.155
				days = { 2 3 }
			}
		}
	}
	option = {# Support the ecumenicals - New Branch Path
		name = bryten_heresy.154.b
		hidden_effect = {
			trigger_event = {
				id = bryten_heresy.156
				days = { 2 3 }
			}
		}

	}
}
bryten_heresy.155 = {# Heretical Breaking
	type = character_event
	title = bryten_heresy.155.t
	desc = bryten_heresy.155.desc
	theme = faith
	
	
	left_portrait = {
		character = root
		animation = personality_zealous
	}
	
	immediate = { play_music_cue = "mx_cue_faith_conversion" }

	option = {# Communal Property
		name = bryten_heresy.155.a
		ai_chance = { base = 50	}
		bryten_fraticelli_heretic_path_communal_scripted_effect = yes 
		# Flag our choice.
		save_scope_value_as = {
			name = bryten_fraticelli_choice
			value = flag:communal_heretic
		}

		stress_impact = {
			humble = minor_stress_impact_loss
			zealous = medium_stress_impact_loss
		}
	}
	option = {# Pacifism
		name = bryten_heresy.155.b
		ai_chance = { base = 25	} # rare 
		 bryten_fraticelli_heretic_path_pacifism_scripted_effect = yes
		# Flag our choice.
		save_scope_value_as = {
			name = bryten_fraticelli_choice
			value = flag:pacifist_heretic
		}

		stress_impact = {
			compassionate = minor_stress_impact_loss
			callous = medium_stress_impact_gain
			sadistic = medium_stress_impact_gain
		}

	}
	option = {# Mendicant Preachers
		name = bryten_heresy.155.c
		ai_chance = { base = 25	} 
		bryten_fraticelli_heretic_path_missionary_scripted_effect = yes
		# Flag our choice.
		save_scope_value_as = {
			name = bryten_fraticelli_choice
			value = flag:missionary_heretic
		}

		stress_impact = {
			lifestyle_traveler = minor_stress_impact_loss
			pilgrim = minor_stress_impact_loss
		}
	}
	
	after = {
		bryten_fraticelli_heretic_path_hof_ecumenical_scripted_effect = yes
		# Now take care of notification events for players.
		every_player = {
			limit = { religion = religion:christianity_religion }
			trigger_event = { id = bryten_heresy.157 }
		}
		# And finally, actually apply the effects.
		if = {
			limit = {
				exists = scope:bryten_fraticelli_choice
				scope:bryten_fraticelli_choice = flag:communal_heretic
			}
			bryten_fraticelli_heretic_path_communal_scripted_effect = yes
		}
		if = {
			limit = {
				exists = scope:bryten_fraticelli_choice
				scope:bryten_fraticelli_choice = flag:pacifist_heretic
			}
			bryten_fraticelli_heretic_path_pacifism_scripted_effect = yes
		}
		if = {
			limit = {
				exists = scope:bryten_fraticelli_choice
				scope:bryten_fraticelli_choice = flag:missionary_heretic
			}
			bryten_fraticelli_heretic_path_missionary_scripted_effect = yes
		}
		every_county = {# Random chance of converting fraticelli's to convert back to catholicism due to radicalism
			limit = { faith = faith:fraticelli }
			random = {
				chance = 10
				set_county_faith = faith:catholic
			}
		}		
	}
}
bryten_heresy.156 = {# New Branch
	type = character_event
	title = bryten_heresy.156.t
	desc = bryten_heresy.156.desc
	theme = faith
	
	
	left_portrait = {
		character = root
		animation = personality_zealous
	}
	
	immediate = { play_music_cue = "mx_cue_faith_conversion" }

	option = {# Pentarchy
		name = bryten_heresy.156.a
		ai_chance = { base = 25	} 
		show_as_tooltip = { bryten_fraticelli_schismatic_path_pentarchy_scripted_effect = yes }
		# Flag our choice.
		save_scope_value_as = {
			name = bryten_fraticelli_choice
			value = flag:pentarchy_ecumenical
		}

		stress_impact = {
			lifestyle_traveler = minor_stress_impact_loss
			pilgrim = minor_stress_impact_loss
		}
	}
	option = {# communion
		name = bryten_heresy.156.b
		ai_chance = { base = 25	} 
		show_as_tooltip = { bryten_fraticelli_schismatic_path_communion_scripted_effect = yes }
		# Flag our choice.
		save_scope_value_as = {
			name = bryten_fraticelli_choice
			value = flag:communion_ecumenical
		}

		stress_impact = {
			lifestyle_traveler = minor_stress_impact_loss
			pilgrim = minor_stress_impact_loss
		}

	}
	option = {# Armed Pilgrimages
		name = bryten_heresy.156.c
		ai_chance = { base = 25	} 
		show_as_tooltip = { bryten_fraticelli_schismatic_path_crusade_scripted_effect = yes }
		# Flag our choice.
		save_scope_value_as = {
			name = bryten_fraticelli_choice
			value = flag:pilgrim_ecumenical
		}

		stress_impact = {
			lifestyle_traveler = minor_stress_impact_loss
			pilgrim = minor_stress_impact_loss
		}
	}	

	after = {
		bryten_fraticelli_schismatic_path_hof_ecumenical_scripted_effect = yes
		# Now take care of notification events for players.
		every_player = {	
			limit = { religion = religion:christianity_religion }
			trigger_event = { id = bryten_heresy.157 }
		}
		# And finally, actually apply the effects.
		if = {
			limit = {
				exists = scope:bryten_fraticelli_choice
				scope:bryten_fraticelli_choice = flag:pentarchy_ecumenical
			}
			bryten_fraticelli_schismatic_path_pentarchy_scripted_effect = yes
		}
		if = {
			limit = {
				exists = scope:bryten_fraticelli_choice
				scope:bryten_fraticelli_choice = flag:communion_ecumenical
			}
			bryten_fraticelli_schismatic_path_communion_scripted_effect = yes
		}
		if = {
			limit = {
				exists = scope:bryten_fraticelli_choice
				scope:bryten_fraticelli_choice = flag:pilgrim_ecumenical
			}
			bryten_fraticelli_schismatic_path_crusade_scripted_effect = yes
		}
		every_county = {# Random chance of converting fraticelli's to convert back to catholicism due to radicalism
			limit = { faith = faith:fraticelli }
			random = {
				chance = 10
				set_county_faith = faith:catholic
			}
		}		
	}	

}
bryten_heresy.157 = {# Let everyone know
	type = character_event
	title = bryten_heresy.157.t
	desc = {
		first_valid = {
			triggered_desc = {# Radical - Fraticelli
				trigger = {
					AND = {
						OR = {
							scope:bryten_fraticelli_choice = flag:communal_heretic
							scope:bryten_fraticelli_choice = flag:pacifist_heretic
							scope:bryten_fraticelli_choice = flag:missionary_heretic
						}
						faith = faith:fraticelli 
					}
				}
				desc = bryten_heresy.157.desc.Radical_fraticelli
			}		
			triggered_desc = {# Ecumenical - Fraticelli
				trigger = { 
					AND = {
						OR = {
							scope:bryten_fraticelli_choice = flag:pentarchy_ecumenical
							scope:bryten_fraticelli_choice = flag:communion_ecumenical
							scope:bryten_fraticelli_choice = flag:pilgrim_ecumenical
						}
						faith = faith:fraticelli 
					}
				}
				desc = bryten_heresy.157.desc.ecumenical_fraticelli
			}			

			triggered_desc = {# Radical
				trigger = { 
					OR = {
						scope:bryten_fraticelli_choice = flag:communal_heretic
						scope:bryten_fraticelli_choice = flag:pacifist_heretic
						scope:bryten_fraticelli_choice = flag:missionary_heretic
					}
					NOT = { faith = faith:fraticelli }
				}
				desc = bryten_heresy.157.desc.Radical
			}
			triggered_desc = {# Ecumenical - Catholic
				trigger = {
					AND = {
						OR = {
							scope:bryten_fraticelli_choice = flag:pentarchy_ecumenical
							scope:bryten_fraticelli_choice = flag:communion_ecumenical
							scope:bryten_fraticelli_choice = flag:pilgrim_ecumenical
						}
						faith = faith:catholic 
					}	
				}
				desc = bryten_heresy.157.desc.ecumenical_catholic
			}
			triggered_desc = {# Ecumenical - Not Catholic
				trigger = { 
					AND = {
						OR = {
							scope:bryten_fraticelli_choice = flag:pentarchy_ecumenical
							scope:bryten_fraticelli_choice = flag:communion_ecumenical
							scope:bryten_fraticelli_choice = flag:pilgrim_ecumenical
						}
						Not = { faith = faith:catholic }
					}
					NOT = { faith = faith:fraticelli }
				}
				desc = bryten_heresy.157.desc.ecumenical_not_catholic
			}
		}
	}
	theme = faith
	
	
	left_portrait = {
		character = root
		animation = personality_zealous
	}
	
	option = {# Condemn the heretics
		name = name_i_see
	}	
}
# Fraticelli Pope Condemns it
bryten_heresy.158 = {# The Pope fully condemns Fraticellism and threatens excommunication
	hidden = yes

	trigger = {
		current_year >= 1323
		NOT = { has_global_variable = fraticelli_condemned_heretics }
		faith:catholic = { exists = faith.religious_head }
		NOR = {# Reasons why the Pope won't condemn the Fraticelli
			AND = {# if Catholicism has low fervor and Fraticelli has high fervor then the pope isn't condeming them
				faith:fraticelli = { fervor > medium_fervor_value }
				faith:catholic = { fervor < medium_fervor_value }
			}
			root.faith.religious_head = { faith = faith:fraticelli }
			faith.religious_head = faith:fraticelli # if the Pope is a Fraticelli member they obviously won't condemn it.
			any_ruler = {# A fraticelli ruler with a strong hook on the Pope the pope won't do it.
				AND = {
 					has_faith = faith:fraticelli
					 has_strong_usable_hook = faith.religious_head

				}
			}
		}
	}

	immediate = {
		root.faith.religious_head =  { save_scope_as = pope }
		set_global_variable = {# Fraticelli are condemend as Heretics
			name = fraticelli_condemned_heretics
			value = yes
		}
		# Fraticelli is now disconnected from the papacy and is more heretical.
		faith:fraticelli = { remove_religious_head_title = yes }
		every_county_in_region = {# Convert counties in the Balkans from Orthodoxy to Bogomilism
			region = world_europe
			limit = {# A large number of provinces convert back as they don't want to be heretics.
				faith = { faith = faith:fraticelli }
			}
			random = {
				chance = 40
				set_county_faith = faith:catholic
			}
		}
		every_ruler = {# give people the ability to convert back
			limit = { faith = faith:fraticelli }
			trigger_event = {
				id = bryten_heresy.159
				days = { 30 50 }
			}
		}
		
	}
}
bryten_heresy.159 = {# Convert to fraticelli?
	type = character_event
	title = bryten_heresy.159.t
	desc = bryten_heresy.159.desc
	theme = faith
	
	
	left_portrait = {
		character = root
		animation = personality_zealous
	}
	
	option = {# Side with the Pope
		name = bryten_heresy.159.a
		ai_chance = { base = 70	}
		set_character_faith = faith:catholic
		reverse_add_opinion = {
			target = scope:pope
			modifier = relieved_opinion
			opinion = 30
		}
		every_vassal = {# Zealous Vassals hate it
			limit = { faith = faith:fraticelli }
			add_opinion = {
				modifier = hate_opinion
				target = root
				opinion = -50
			}
		}
		every_vassal = {# Zealous Vassals hate it
			limit = { faith = faith:fraticelli }
			add_opinion = {
				modifier = hate_opinion
				target = root
				opinion = -50
			}
		}
		
		stress_impact = {
			greedy = major_stress_impact_loss
			cynical = major_stress_impact_loss
			generous = medium_stress_impact_gain
			improvident = major_stress_impact_gain
			zealous = medium_stress_impact_gain
		}
	}
	option = {# Stick with Fraticelli despite things
		name = bryten_heresy.159.b
		ai_chance = { base = 30	} # rare 
		add_piety = medium_piety_gain
		reverse_add_opinion = {
			target = scope:pope
			modifier = hate_opinion
			opinion = -50
		}
		every_vassal = {# Catholic Vassals hate it
			limit = { faith = faith:catholic }
			add_opinion = {
				modifier = did_not_listen_to_pope
				target = root
				opinion = -30
			}
		}
		every_courtier_or_guest = {# Catholic guests/Courtiers hate it
			limit = { faith = faith:catholic }
			add_opinion = {
				modifier = did_not_listen_to_pope
				target = root
				opinion = -30
			}
		}
		stress_impact = {
			greedy = major_stress_impact_gain
			cynical = major_stress_impact_gain
			generous = medium_stress_impact_loss
			improvident = major_stress_impact_loss
			zealous = medium_stress_impact_loss
		}

	}
}
#######################################
# henricians 
#######################################
bryten_heresy.175 = {# Waldo begins preaching
	hidden = yes

	immediate = {
		random_county_in_region = {
			region = custom_henricians_region
			save_scope_as = henricianism_county
		}
		create_character = {# Henry
			name = "Henry"
			gender = male
			location = scope:henricianism_county.title_province
			age = 30
			faith = faith:henricians
			culture = culture:occitan
			trait = heresiarch
			trait = generous
			trait = theologian
			trait = improvident
			trait = education_learning_4
			save_scope_as = henricians_founder
		}
		set_global_variable = {
			name = henricians_spawned
			value = yes
		}
		# Unlock henricians to convert to and be a heresy more generally
		faith:henricians = { remove_doctrine = unavailable_doctrine }
		every_county_in_region = {# Convert counties in the Balkans from Orthodoxy to Bogomilism
			region = custom_henricians_region
			limit = {# this should only apply to Ecumenical faiths, ie catholic and Orthodox mainly.
				faith = {
					has_doctrine = special_doctrine_ecumenical_christian
				}
			}
			random = {
				chance = 5
				set_county_faith = faith:henricians
				add_county_modifier = {
					modifier = rebellious_people
					years = 10
				}
			}
		}
		every_ruler = {# give people the ability to convert
			limit = { capital_province = { geographical_region = custom_henricians_region } }
			trigger_event = {
				id = bryten_heresy.176
				days = { 30 50 }
			}
		}
		
	}
}
bryten_heresy.176 = {# Convert to henricians?
	type = character_event
	title = bryten_heresy.176.t
	desc = bryten_heresy.176.desc
	theme = faith
	
	
	left_portrait = {
		character = root
		animation = personality_zealous
	}
	
	immediate = {

	}

	option = {# Condemn the heretics
		name = bryten_heresy.176.a
		ai_chance = { base = 89	}
		every_vassal = {# Zealous Vassals love it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = approves_heretic_condemnation
				target = root
				opinion = 40
			}
		}
	}
	option = {# Let him preach
		name = bryten_heresy.176.b
		ai_chance = { base = 20	} # rare 
		every_vassal = {# Zealous Vassals hate it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = disapproves_heretic_toleration
				target = root
				opinion = -40
			}
		}
		every_held_title = {# henricians counties are really happy
			limit = {
				tier = tier_county
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}	
		hidden_effect = {
			random = {# convert more areas to henricians
				chance = 5
				every_held_title = {
					limit = {
						tier = tier_county
						NOT = { faith = faith:fraticelli }
						faith = {# this is to ensure its a reaction to catholicism not any other heretical movement
							has_doctrine = special_doctrine_ecumenical_christian
						}
					}
					set_county_faith = faith:henricians
				}
			}			
		}
	}
	option = {# he is interesting ideas
		name = bryten_heresy.176.c
		ai_chance = { base = 01	} # super rare mainly for players
		faith:henricians = { 
			change_fervor = { 
				value = 5	
				desc = bryten_fervor_gain_heretical_lord
			} 
		}
		set_character_faith = faith:henricians
		every_held_title = {# henricians counties are really happy
			limit = {
				tier = tier_county
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}
	}	
}
# Council: Council gathers from all over
bryten_heresy.177 = {# council: Clergy gather from all over
	type = character_event
	title = bryten_heresy.177.t
	desc = bryten_heresy.177.desc
	theme = learning
	left_portrait = {
		character = scope:henricians_council_host
		animation = personality_rational
	}
	right_portrait = {
		character = scope:henricians_priest_at_council
		animation = chancellor
	}
	override_background = { reference = temple_scope }

	immediate = {
		# You are a heresiarch
		add_trait = heresiarch
		# Sort our locale.
		## First, whether this is a repeater.
		scope:council_1_venue = {
			## Preferring to chill at scope:henricians_priest's place.
			if = {
				limit = { holder = scope:henricians_priest }
				save_scope_as = council_2_venue
			}
			## But otherwise we take your capital.
			else = {
				scope:henricians_council_host.capital_barony = { save_scope_as = council_2_venue }
			}
		}
		scope:council_2_venue = { save_scope_as = background_temple_scope }
		scope:henricians_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = henricians_priest_at_council
			}
		}
	}

	
	option = {# Naturally, I'll take a leading role in the discussions.
		name = bryten_heresy.177.a

		# You'll engage in learning debates.
		custom_tooltip = bryten_heresy.177.a.tt
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:debate
		}
		stress_impact = {
			gregarious = miniscule_stress_impact_loss
			shy = medium_stress_impact_gain
		}
		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 0
		}
	}
	option = {# My influence will be more felt than seen...
		name = bryten_heresy.177.b
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:piety
		}
		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 0
		}
	}
	option = {# This is a matter for the clergy alone.
		name = bryten_heresy.177.c
		custom_tooltip = bryten_heresy.177.c.tt
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:defaulted
		}
		stress_impact = {
			humble = miniscule_stress_impact_loss
			arrogant = major_stress_impact_gain
		}
		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 100
		}
	}


	after = {
		trigger_event = {
			id = bryten_heresy.178
			days = {5 10}
		}
	}
}
# Council: The priesthood
scripted_effect bryten_heresy_council_henricians_hof_effect = {
	faith:henricians = { 
		hidden_effect = { remove_doctrine = doctrine_theocracy_lay_clergy }
		add_doctrine = doctrine_theocracy_temporal
		add_doctrine = doctrine_spiritual_head
		set_up_dynamic_spiritual_hof_title_effect = { CREATOR = scope:henricians_council_host }
	}
}
scripted_effect bryten_heresy_council_henricians_spiritual_effect = {
	faith:henricians = { 
		hidden_effect = { remove_doctrine = doctrine_theocracy_lay_clergy }
		add_doctrine = doctrine_theocracy_temporal 
	}
}
scripted_effect bryten_heresy_council_henricians_lay_priests_effect = {
	faith:henricians = { 
		add_doctrine = doctrine_theocracy_lay_clergy 
	}
}
bryten_heresy.178 = {# Council: priesthood
	type = character_event
	title = bryten_heresy.178.t
	desc = bryten_heresy.178.desc
	theme = diplomacy
	left_portrait = {
		character = scope:henricians_council_host
		animation = personality_bold
	}
	right_portrait = {
		character = scope:henricians_priest_at_council
		animation = personality_bold
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:henricians_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:henricians_priest_at_council }
			clear_saved_scope = henricians_priest_at_council
		}
		## Now try to refresh it.
		scope:henricians_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = henricians_priest_at_council
			}
		}
	}

	option = {# Spiritual + Hof
		name = bryten_heresy.178.a
		trigger = { 
			OR = {
				not = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:henricians_council_stance_clergy = flag:henricians_council_stance_hof	}
			}
		}
		if = {# going against Henry of Lusanne himself is costly
				limit = { scope:henricians_priest = { has_character_flag = henricians_priest_is_henry }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_henricians_hof_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.178.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.178.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_henricians_hof_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.178.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.178.a.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:henricians_priest's preference.
						## Spiritual.
						if = {
							limit = { scope:henricians_council_stance_clergy = flag:henricians_council_stance_spiritual }
							bryten_heresy_council_henricians_spiritual_effect = yes
						}
						## Lay Clergy.
						if = {
							limit = { scope:henricians_council_stance_clergy = flag:henricians_council_stance_lay_clergy }
							bryten_heresy_council_henricians_lay_priests_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 0
		}
	}
	option = {# Spiritual
		name = bryten_heresy.178.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:henricians_council_stance_clergy = flag:henricians_council_stance_spiritual }
			}
		}

		if = {# going against Henry of Lusanne himself is costly
				limit = { scope:henricians_priest = { has_character_flag = henricians_priest_is_henry }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		if = {# Piety path.
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_henricians_spiritual_effect = yes
		}
		if = {# Debate path.
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.178.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.178.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_henricians_spiritual_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.178.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.178.b.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:henricians_priest's preference.
						## Spiritual + Hof.
						if = {
							limit = { scope:henricians_council_stance_clergy = flag:henricians_council_stance_hof }
							bryten_heresy_council_henricians_hof_effect = yes
						}
						## Lay Clergy.
						if = {
							limit = { scope:henricians_council_stance_clergy = flag:henricians_council_stance_lay_clergy }
							bryten_heresy_council_henricians_lay_priests_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 0
		}
	}
	option = {# Lay Clergy
		name = bryten_heresy.178.c
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:henricians_council_stance_clergy = flag:henricians_council_stance_lay_clergy	}
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_henricians_lay_priests_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.178.c.tt.success
					send_interface_toast = {
						title = bryten_heresy.178.c.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_henricians_lay_priests_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.178.c.tt.failure
					send_interface_toast = {
						title = bryten_heresy.178.c.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:henricians_priest's preference.
						## Spiritual + Hof.
						if = {
							limit = { scope:henricians_council_stance_clergy = flag:henricians_council_stance_hof }
							bryten_heresy_council_henricians_hof_effect = yes
						}
						## Spiritual.
						if = {
							limit = { scope:henricians_council_stance_clergy = flag:henricians_council_stance_spiritual }
							bryten_heresy_council_henricians_spiritual_effect = yes
						}
					}
				}
			}
		}

		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 0
		}
	}
	option = {# I have no opinion on this matter.
		name = bryten_heresy.178.d

		# We take scope:henricians_priest's preference.
		## Spiritual + Hof.
		if = {
			limit = { scope:henricians_council_stance_clergy = flag:henricians_council_stance_hof }
			bryten_heresy_council_henricians_hof_effect = yes
		}
		## Spiritual.
		if = {
			limit = { scope:henricians_council_stance_clergy = flag:henricians_council_stance_spiritual }
			bryten_heresy_council_henricians_spiritual_effect = yes
		}
		## Lay Clergy.
		if = {
			limit = { scope:henricians_council_stance_clergy = flag:henricians_council_stance_lay_clergy }
			bryten_heresy_council_henricians_lay_priests_effect = yes
		}

		# We don't charge stress for the opt-outs, not least because their results are variable.
		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.179
			days = {5 10}
		}
	}
}
# Council: Female Clergy
scripted_effect bryten_heresy_council_henricians_no_women = {
	faith:henricians = { 
		add_doctrine = doctrine_clerical_gender_male_only
	}
}
scripted_effect bryten_heresy_council_henricians_yes_women = {
	faith:henricians = { 
		hidden_effect = { remove_doctrine = doctrine_clerical_gender_male_only }
		add_doctrine = doctrine_clerical_gender_either 
	}
}
bryten_heresy.179 = {# Council: Female Clergy
	type = character_event
	title = bryten_heresy.179.t
	desc = bryten_heresy.179.desc
	theme = martial
	left_portrait = {
		character = scope:henricians_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:henricians_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:henricians_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:henricians_priest_at_council }
			clear_saved_scope = henricians_priest_at_council
		}
		## Now try to refresh it.
		scope:henricians_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = henricians_priest_at_council
			}
		}
	}

	option = {# No female
		name = bryten_heresy.179.a
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted } 
				NOT = {	scope:henricians_council_stance_female = flag:henricians_council_stance_no_female_clergy }
			}
		}


		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_henricians_no_women = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.179.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.179.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_henricians_no_women = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.179.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.179.a.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_henricians_yes_women = yes
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 0
		}
	}
	option = {# Female clergy
		name = bryten_heresy.179.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted } 
				NOT = {	scope:henricians_council_stance_female = flag:henricians_council_stance_yes_female_clergy }
			}
		}
		if = {# going against Henry of Lusanne himself is costly
				limit = { scope:henricians_priest = { has_character_flag = henricians_priest_is_henry }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_henricians_yes_women = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.179.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.179.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_henricians_yes_women = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.179.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.179.b.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_henricians_no_women = yes
					}
				}
			}
		}

		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 0
		}
	}
	option = {# The clergy decide
		name = bryten_heresy.179.d

		# We take scope:henricians_priest's preference.
		## No Female Clergy.
		if = {
			limit = { scope:henricians_council_stance_female = flag:henricians_council_stance_no_female_clergy }
			bryten_heresy_council_henricians_no_women = yes
		}
		## Allow Female Clergy.
		if = {
			limit = { scope:henricians_council_stance_female = flag:henricians_council_stance_yes_female_clergy }
			bryten_heresy_council_henricians_yes_women = yes
		}
		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.180
			days = {5 10}
		}
	}
}
# Council: Divorce
scripted_effect bryten_heresy_council_henricians_no_divorce = {
	faith:henricians = { 
		add_doctrine = doctrine_divorce_disallowed }
}
scripted_effect bryten_heresy_council_henricians_approve_divorce = {
	faith:henricians = { 
		add_doctrine = doctrine_divorce_approval 
	}
}
bryten_heresy.180 = {# Council: Divorce
	type = character_event
	title = bryten_heresy.180.t
	desc = bryten_heresy.180.desc
	theme = martial
	left_portrait = {
		character = scope:henricians_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:henricians_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:henricians_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:henricians_priest_at_council }
			clear_saved_scope = henricians_priest_at_council
		}
		## Now try to refresh it.
		scope:henricians_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = henricians_priest_at_council
			}
		}
	}

	option = {# No Divorce
		name = bryten_heresy.180.a
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:henricians_council_stance_divorce = flag:henricians_council_stance_no_divorce	}
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_henricians_no_divorce = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.180.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.180.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_henricians_no_divorce = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.180.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.180.a.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_henricians_approve_divorce = yes

					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 0
		}
	}
	option = {# Allow Divorce
		name = bryten_heresy.180.b
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:henricians_council_stance_divorce = flag:henricians_council_stance_yes_divorce }
			}
		}
		if = {# going against Henry of Lusanne himself is costly
				limit = { scope:henricians_priest = { has_character_flag = henricians_priest_is_henry }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_henricians_approve_divorce = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.180.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.180.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_henricians_approve_divorce = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.180.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.180.b.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_henricians_no_divorce = yes

					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 0
		}
	}
	option = {# The Clergy decide
		name = bryten_heresy.180.d

		# We take scope:henricians_priest's preference.
		if = {# No Divorce
			limit = { scope:henricians_council_stance_divorce = flag:henricians_council_stance_no_divorce }
			bryten_heresy_council_henricians_no_divorce = yes
		}
		if = {# Allow Divorce
			limit = { scope:henricians_council_stance_divorce = flag:henricians_council_stance_yes_divorce }
			bryten_heresy_council_henricians_approve_divorce = yes
		}

		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 100
		}
	}
	
	after = {
		trigger_event = {
			id = bryten_heresy.181
			days = { 5 10 }
		}
	}

}
# Council: Pilgrimage
scripted_effect bryten_heresy_council_henricians_no_pilgrimage = {
	faith:henricians = { 
		add_doctrine = doctrine_pilgrimage_forbidden 
	}
}
scripted_effect bryten_heresy_council_henricians_yes_pilgrimage = {
	faith:henricians = { 
		hidden_effect = { remove_doctrine = doctrine_pilgrimage_forbidden }
		add_doctrine = doctrine_pilgrimage_encouraged 
	}
}
bryten_heresy.181 = {# Council: Pilgrimage
	type = character_event
	title = bryten_heresy.181.t
	desc = bryten_heresy.181.desc
	theme = martial
	left_portrait = {
		character = scope:henricians_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:henricians_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:henricians_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:henricians_priest_at_council }
			clear_saved_scope = henricians_priest_at_council
		}
		## Now try to refresh it.
		scope:henricians_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = henricians_priest_at_council
			}
		}
	}

	option = {# No Pilgrimage
		name = bryten_heresy.181.a
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:henricians_council_stance_pilgrimage = flag:henricians_council_stance_forbid_pilgriamge }
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_henricians_no_pilgrimage = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.181.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.181.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_henricians_no_pilgrimage = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.181.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.181.a.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_henricians_yes_pilgrimage = yes
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 0
		}
	}
	option = {# Yes Pilgrimage
		name = bryten_heresy.181.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:henricians_council_stance_pilgrimage = flag:henricians_council_stance_allow_pilgrimage }
			}
		}
		if = {# going against Henry of Lusanne himself is costly
				limit = { scope:henricians_priest = { has_character_flag = henricians_priest_is_henry }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_henricians_yes_pilgrimage = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.181.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.181.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_henricians_yes_pilgrimage = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.181.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.181.b.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_henricians_no_pilgrimage = yes

					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 0
		}
	}
	option = {# Clergy Decide
		name = bryten_heresy.181.d

		if = {# No Pilgrimages
			limit = { scope:henricians_council_stance_pilgrimage = flag:henricians_council_stance_forbid_pilgriamge }
			bryten_heresy_council_henricians_no_pilgrimage = yes
		}
		if = {# Yes Pilgrimages
			limit = { scope:henricians_council_stance_pilgrimage = flag:henricians_council_stance_allow_pilgrimage }
			bryten_heresy_council_henricians_yes_pilgrimage = yes
		}
		ai_chance = {
			# The AI should just let the scope:henricians_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.182
			days = {5 10}
		}
	}
}
# council results
bryten_heresy.182 = {# The church council arrives at their final important doctrinal conclusions.
	type = character_event
	title = bryten_heresy.182.t
	desc = {
		desc = bryten_heresy.182.desc.intro
		first_valid = {# Priesthood
			triggered_desc = {# Spiritual + Hof
				trigger = {	faith:henricians = { has_doctrine = doctrine_spiritual_head } }
				desc = bryten_heresy.182.desc.hof
			}
			triggered_desc = {# Spiritual 
				trigger = {
					faith:henricians = { 
						NOT = {	has_doctrine = doctrine_spiritual_head }
						has_doctrine = doctrine_theocracy_temporal 
					}
				}
				desc = bryten_heresy.182.desc.priests
			}
			triggered_desc = {# Lay Clergy
				trigger = {	faith:henricians = { has_doctrine = doctrine_theocracy_lay_clergy }	}
				desc = bryten_heresy.182.desc.lay
			}
		}
		first_valid = {# female clergy
			triggered_desc = {# No Female Clergy
				trigger = {	faith:henricians = { has_doctrine = doctrine_clerical_gender_male_only } }
				desc = bryten_heresy.182.desc.male_only
			}
			triggered_desc = {# Yes Female Clergy
				trigger = {	faith:henricians = { has_doctrine = doctrine_clerical_gender_either }	}
				desc = bryten_heresy.182.desc.female_clergy
			}
		}
		first_valid = {# Divorce
			triggered_desc = {# No Divorce
				trigger = {	faith:henricians = { has_doctrine = doctrine_divorce_disallowed } }
				desc = bryten_heresy.182.desc.divorce_banned
			}
			triggered_desc = {# Yes Divorce
				trigger = {	faith:henricians = { has_doctrine = doctrine_divorce_approval } }
				desc = bryten_heresy.182.desc.divorce_allowed
			}
		}
		first_valid = {# Pilgrimage
			triggered_desc = {# No Pilgrimage
				trigger = {	faith:henricians = { has_doctrine = doctrine_pilgrimage_forbidden } }
				desc = bryten_heresy.182.desc.pilgrimage_forbidden
			}
			triggered_desc = {# Yes Pilgrimage
				trigger = {	faith:henricians = { has_doctrine = doctrine_pilgrimage_encouraged } }
				desc = bryten_heresy.182.desc.pilgrimage_allowed
			}
		}
		# Outro.
		desc = bryten_heresy.182.desc.outro
	}
	theme = faith
	left_portrait = {
		character = scope:henricians_council_host
		animation = personality_bold
	}
	right_portrait = {
		character = scope:henricians_priest_at_council
		animation = chancellor
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Music!
		play_music_cue = "mx_cue_sacredrite"
		faith:henricians = {# the Council is over and now is formulized
			remove_doctrine = heretic_movement_doctrine
			change_fervor = { 
				value = 50
				desc = bryten_fervor_gain_henricians_council	
			} 
		}
		# Now let's display our choices.
		faith:henricians = {
			show_as_tooltip = {
				# Gnosticism.
				if = {
					limit = { has_doctrine = doctrine_pluralism_righteous }
					add_doctrine = doctrine_pluralism_righteous
				}
				if = {
					limit = { has_doctrine = doctrine_pluralism_righteous }
					add_doctrine = doctrine_pluralism_righteous
				}
				if = {
					limit = { has_doctrine = doctrine_pluralism_pluralistic }
					add_doctrine = doctrine_pluralism_pluralistic
				}
				# Priesthood.
				if = {
					limit = { has_doctrine = doctrine_spiritual_head }
					add_doctrine = doctrine_theocracy_temporal
					add_doctrine = doctrine_spiritual_head
				}
				if = {
					limit = { 
						has_doctrine = doctrine_theocracy_temporal 
						NOT = { has_doctrine = doctrine_spiritual_head }
					}
					add_doctrine = doctrine_theocracy_temporal
				}
				if = {
					limit = { has_doctrine = doctrine_theocracy_lay_clergy }
					add_doctrine = doctrine_theocracy_lay_clergy
				}
				# Wealth.
				if = {
					limit = { has_doctrine = tenet_communal_possessions }
					add_doctrine = tenet_communal_possessions
				}
				if = {
					limit = { has_doctrine = tenet_apostolic_poverty }
					add_doctrine = tenet_apostolic_poverty
				}
				if = {
					limit = { has_doctrine = tenet_pure_priesthood }
					add_doctrine = tenet_pure_priesthood
				}
				# Pacifism.
				if = {
					limit = { has_doctrine = tenet_armed_pilgrimages }
					add_doctrine = tenet_armed_pilgrimages
				}
				if = {
					limit = { has_doctrine = tenet_pacifism }
					add_doctrine = tenet_pacifism
				}
				if = {
					limit = { has_doctrine = tenet_unrelenting_faith }
					add_doctrine = tenet_unrelenting_faith
				}
			}


		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:bryten_henricians_council_completed
		}


	}

	option = {
		name = bryten_heresy.182.a
		add_piety = major_piety_gain

	}

	after = {
		# Clean up the story.
		every_player = {# letting players know that the henricians church has been formalized
			trigger_event = {
				id = bryten_heresy.183
				days = {5 10}
			}
		}
	}
}
bryten_heresy.183 = {# henricians Council(let players know)
	type = character_event
	title = bryten_heresy.183.t
	desc = bryten_heresy.183.desc
	theme = faith	


	option = {# Condemn the heretic
		name = bryten_heresy.183.a
	}
}
#######################################
# petrobrusian 
#######################################
bryten_heresy.200 = {# Peter of Bruys begins preaching
	hidden = yes

	immediate = {
		random_county_in_region = {
			region = custom_petrobrusian_region
			save_scope_as = petrobrusian_county
		}
		create_character = {# Peter
			name = "Peter"
			gender = male
			location = scope:petrobrusian_county.title_province
			age = 30
			faith = faith:petrobrusian
			culture = culture:french
			trait = heresiarch
			trait = generous
			trait = theologian
			trait = improvident
			trait = education_learning_4
			save_scope_as = petrobrusian_founder
		}
		set_global_variable = {
			name = petrobrusian_spawned
			value = yes
		}
		# Unlock Bogomilism to convert to and be a heresy more generally
		faith:petrobrusian = { remove_doctrine = unavailable_doctrine }
		every_county_in_region = {# Convert counties in the Balkans from Orthodoxy to Bogomilism
			region = custom_petrobrusian_region
			limit = {# this should only apply to Ecumenical faiths, ie catholic and Orthodox mainly.
				faith = { has_doctrine = special_doctrine_ecumenical_christian }
			}
			random = {
				chance = 5
				set_county_faith = faith:petrobrusian
				add_county_modifier = {
					modifier = rebellious_people
					years = 10
				}
			}
		}
		every_ruler = {# give people the ability to convert
			limit = { capital_province = { geographical_region = custom_petrobrusian_region } }
			trigger_event = {
				id = bryten_heresy.201
				days = { 30 50 }
			}
		}
		
	}
}
bryten_heresy.201 = {# Convert to petrobrusian?
	type = character_event
	title = bryten_heresy.201.t
	desc = bryten_heresy.201.desc
	theme = faith
	
	
	left_portrait = {
		character = root
		animation = personality_zealous
	}
	
	immediate = {

	}

	option = {# Condemn the heretics
		name = bryten_heresy.201.a
		ai_chance = { base = 89	}
		every_vassal = {# Zealous Vassals love it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = approves_heretic_condemnation
				target = root
				opinion = 40
			}
		}
	}
	option = {# Let him preach
		name = bryten_heresy.201.b
		ai_chance = { base = 20	} # rare 
		every_vassal = {# Zealous Vassals hate it
			limit = { has_vassal_stance = zealot }
			add_opinion = {
				modifier = disapproves_heretic_toleration
				target = root
				opinion = -40
			}
		}
		every_held_title = {# petrobrusian counties are really happy
			limit = {
				tier = tier_county
				faith = faith:petrobrusian
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}	
		hidden_effect = {
			random = {# convert more areas to petrobrusian
				chance = 5
				every_held_title = {
					limit = {
						tier = tier_county
						NOT = { faith = faith:petrobrusian }
						faith = {# this is to ensure its a reaction to catholicism not any other heretical movement
							has_doctrine = special_doctrine_ecumenical_christian
						}
					}
					set_county_faith = faith:petrobrusian
				}
			}			
		}

	}
	option = {# he is interesting ideas
		name = bryten_heresy.201.c
		ai_chance = { base = 01	} # super rare mainly for players
		faith:petrobrusian = { 
			change_fervor = { 
				value = 5
				desc = bryten_fervor_gain_heretical_lord	
			} 
		}
		set_character_faith = faith:petrobrusian
		every_held_title = {# Petrobrusians counties are really happy
			limit = {
				tier = tier_county
				faith = faith:petrobrusian
				has_county_modifier = rebellious_people
			}
			remove_county_modifier = rebellious_people
		}
	}	
}
# Council: Council gathers from all over
bryten_heresy.202 = {# council: Clergy gather from all over
	type = character_event
	title = bryten_heresy.202.t
	desc = bryten_heresy.202.desc
	theme = learning
	left_portrait = {
		character = scope:petrobrusian_council_host
		animation = personality_rational
	}
	right_portrait = {
		character = scope:petrobrusian_priest_at_council
		animation = chancellor
	}
	override_background = { reference = temple_scope }

	immediate = {
		# You are a heresiarch
		add_trait = heresiarch
		# Sort our locale.
		## First, whether this is a repeater.
		scope:council_1_venue = {
			## Preferring to chill at scope:petrobrusian_priest's place.
			if = {
				limit = { holder = scope:petrobrusian_priest }
				save_scope_as = council_2_venue
			}
			## But otherwise we take your capital.
			else = {
				scope:petrobrusian_council_host.capital_barony = { save_scope_as = council_2_venue }
			}
		}
		scope:council_2_venue = { save_scope_as = background_temple_scope }
		scope:petrobrusian_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = petrobrusian_priest_at_council
			}
		}
	}

	
	option = {# Naturally, I'll take a leading role in the discussions.
		name = bryten_heresy.202.a

		# You'll engage in learning debates.
		custom_tooltip = bryten_heresy.202.a.tt
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:debate
		}
		stress_impact = {
			gregarious = miniscule_stress_impact_loss
			shy = medium_stress_impact_gain
		}
		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 0
		}
	}
	option = {# My influence will be more felt than seen...
		name = bryten_heresy.202.b
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:piety
		}
		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 0
		}
	}
	option = {# This is a matter for the clergy alone.
		name = bryten_heresy.202.c
		custom_tooltip = bryten_heresy.202.c.tt
		save_scope_value_as = {
			name = conclave_engagement
			value = flag:defaulted
		}
		stress_impact = {
			humble = miniscule_stress_impact_loss
			arrogant = major_stress_impact_gain
		}
		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 100
		}
	}


	after = {
		trigger_event = {
			id = bryten_heresy.203
			days = {5 10}
		}
	}
}
# Council: The priesthood
scripted_effect bryten_heresy_council_petrobrusian_hof_effect = {
	faith:petrobrusian = { 
		hidden_effect = { remove_doctrine = doctrine_theocracy_lay_clergy }
		add_doctrine = doctrine_theocracy_temporal
		add_doctrine = doctrine_spiritual_head
		set_up_dynamic_spiritual_hof_title_effect = { CREATOR = scope:petrobrusian_council_host }
	}
}
scripted_effect bryten_heresy_council_petrobrusian_spiritual_effect = {
	faith:petrobrusian = { 
		hidden_effect = { remove_doctrine = doctrine_theocracy_lay_clergy }
		add_doctrine = doctrine_theocracy_temporal 
	}
}
scripted_effect bryten_heresy_council_petrobrusian_lay_priests_effect = {
	faith:petrobrusian = { 
		add_doctrine = doctrine_theocracy_lay_clergy 
	}
}
bryten_heresy.203 = {# Council: priesthood
	type = character_event
	title = bryten_heresy.203.t
	desc = bryten_heresy.203.desc
	theme = diplomacy
	left_portrait = {
		character = scope:petrobrusian_council_host
		animation = personality_bold
	}
	right_portrait = {
		character = scope:petrobrusian_priest_at_council
		animation = personality_bold
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:petrobrusian_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:petrobrusian_priest_at_council }
			clear_saved_scope = petrobrusian_priest_at_council
		}
		## Now try to refresh it.
		scope:petrobrusian_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = petrobrusian_priest_at_council
			}
		}
	}

	option = {# Spiritual + Hof
		name = bryten_heresy.203.a
		trigger = { 
			OR = {
				not = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:petrobrusian_council_stance_clergy = flag:petrobrusian_council_stance_hof	}
			}
		}
		if = {# going against Peter of Bruys himself is costly
				limit = { scope:petrobrusian_priest = { has_character_flag = petrobrusian_priest_is_peter }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_petrobrusian_hof_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.203.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.203.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_petrobrusian_hof_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.203.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.203.a.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:petrobrusian_priest's preference.
						## Spiritual.
						if = {
							limit = { scope:petrobrusian_council_stance_clergy = flag:petrobrusian_council_stance_spiritual }
							bryten_heresy_council_petrobrusian_spiritual_effect = yes
						}
						## Lay Clergy.
						if = {
							limit = { scope:petrobrusian_council_stance_clergy = flag:petrobrusian_council_stance_lay_clergy }
							bryten_heresy_council_petrobrusian_lay_priests_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 0
		}
	}
	option = {# Spiritual
		name = bryten_heresy.203.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:petrobrusian_council_stance_clergy = flag:petrobrusian_council_stance_spiritual }
			}
		}
		if = {# going against Peter of Bruys himself is costly
				limit = { scope:petrobrusian_priest = { has_character_flag = petrobrusian_priest_is_peter }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		if = {# Piety path.
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_petrobrusian_spiritual_effect = yes
		}
		if = {# Debate path.
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.203.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.203.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_petrobrusian_spiritual_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.203.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.203.b.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:petrobrusian_priest's preference.
						## Spiritual + Hof.
						if = {
							limit = { scope:petrobrusian_council_stance_clergy = flag:petrobrusian_council_stance_hof }
							bryten_heresy_council_petrobrusian_hof_effect = yes
						}
						## Lay Clergy.
						if = {
							limit = { scope:petrobrusian_council_stance_clergy = flag:petrobrusian_council_stance_lay_clergy }
							bryten_heresy_council_petrobrusian_lay_priests_effect = yes
						}
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 0
		}
	}
	option = {# Lay Clergy
		name = bryten_heresy.203.c
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:petrobrusian_council_stance_clergy = flag:petrobrusian_council_stance_lay_clergy	}
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_petrobrusian_lay_priests_effect = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.203.c.tt.success
					send_interface_toast = {
						title = bryten_heresy.203.c.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_petrobrusian_lay_priests_effect = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.203.c.tt.failure
					send_interface_toast = {
						title = bryten_heresy.203.c.tt.failure
						left_icon = scope:council_1_venue
						# We take scope:petrobrusian_priest's preference.
						## Spiritual + Hof.
						if = {
							limit = { scope:petrobrusian_council_stance_clergy = flag:petrobrusian_council_stance_hof }
							bryten_heresy_council_petrobrusian_hof_effect = yes
						}
						## Spiritual.
						if = {
							limit = { scope:petrobrusian_council_stance_clergy = flag:petrobrusian_council_stance_spiritual }
							bryten_heresy_council_petrobrusian_spiritual_effect = yes
						}
					}
				}
			}
		}

		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 0
		}
	}
	option = {# I have no opinion on this matter.
		name = bryten_heresy.203.d

		# We take scope:petrobrusian_priest's preference.
		## Spiritual + Hof.
		if = {
			limit = { scope:petrobrusian_council_stance_clergy = flag:petrobrusian_council_stance_hof }
			bryten_heresy_council_petrobrusian_hof_effect = yes
		}
		## Spiritual.
		if = {
			limit = { scope:petrobrusian_council_stance_clergy = flag:petrobrusian_council_stance_spiritual }
			bryten_heresy_council_petrobrusian_spiritual_effect = yes
		}
		## Lay Clergy.
		if = {
			limit = { scope:petrobrusian_council_stance_clergy = flag:petrobrusian_council_stance_lay_clergy }
			bryten_heresy_council_petrobrusian_lay_priests_effect = yes
		}

		# We don't charge stress for the opt-outs, not least because their results are variable.
		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.204
			days = {5 10}
		}
	}
}
# Council: Female Clergy
scripted_effect bryten_heresy_council_petrobrusian_no_women = {
	faith:petrobrusian = { 
		add_doctrine = doctrine_clerical_gender_male_only
	}
}
scripted_effect bryten_heresy_council_petrobrusian_yes_women = {
	faith:petrobrusian = { 
		hidden_effect = { remove_doctrine = doctrine_clerical_gender_male_only }
		add_doctrine = doctrine_clerical_gender_either 
	}
}
bryten_heresy.204 = {# Council: Female Clergy
	type = character_event
	title = bryten_heresy.204.t
	desc = bryten_heresy.204.desc
	theme = martial
	left_portrait = {
		character = scope:petrobrusian_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:petrobrusian_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:petrobrusian_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:petrobrusian_priest_at_council }
			clear_saved_scope = petrobrusian_priest_at_council
		}
		## Now try to refresh it.
		scope:petrobrusian_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = petrobrusian_priest_at_council
			}
		}
	}

	option = {# No female
		name = bryten_heresy.204.a
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted } 
				NOT = {	scope:petrobrusian_council_stance_female = flag:petrobrusian_council_stance_no_female_clergy }
			}
		}


		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_petrobrusian_no_women = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.204.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.204.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_petrobrusian_no_women = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.204.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.204.a.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_petrobrusian_yes_women = yes
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 0
		}
	}
	option = {# Female clergy
		name = bryten_heresy.204.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted } 
				NOT = {	scope:petrobrusian_council_stance_female = flag:petrobrusian_council_stance_yes_female_clergy }
			}
		}
		if = {# going against Peter of Bruys himself is costly
				limit = { scope:petrobrusian_priest = { has_character_flag = petrobrusian_priest_is_peter }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_petrobrusian_yes_women = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.204.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.204.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_petrobrusian_yes_women = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.204.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.204.b.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_petrobrusian_no_women = yes
					}
				}
			}
		}

		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 0
		}
	}
	option = {# The clergy decide
		name = bryten_heresy.204.d

		# We take scope:petrobrusian_priest's preference.
		## No Female Clergy.
		if = {
			limit = { scope:petrobrusian_council_stance_female = flag:petrobrusian_council_stance_no_female_clergy }
			bryten_heresy_council_petrobrusian_no_women = yes
		}
		## Allow Female Clergy.
		if = {
			limit = { scope:petrobrusian_council_stance_female = flag:petrobrusian_council_stance_yes_female_clergy }
			bryten_heresy_council_petrobrusian_yes_women = yes
		}
		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.205
			days = {5 10}
		}
	}
}
# Council: Divorce
scripted_effect bryten_heresy_council_petrobrusian_no_divorce = {
	faith:petrobrusian = { 
		add_doctrine = doctrine_divorce_disallowed }
}
scripted_effect bryten_heresy_council_petrobrusian_approve_divorce = {
	faith:petrobrusian = { 
		add_doctrine = doctrine_divorce_approval 
	}
}
bryten_heresy.205 = {# Council: Divorce
	type = character_event
	title = bryten_heresy.205.t
	desc = bryten_heresy.205.desc
	theme = martial
	left_portrait = {
		character = scope:petrobrusian_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:petrobrusian_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:petrobrusian_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:petrobrusian_priest_at_council }
			clear_saved_scope = petrobrusian_priest_at_council
		}
		## Now try to refresh it.
		scope:petrobrusian_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = petrobrusian_priest_at_council
			}
		}
	}

	option = {# No Divorce
		name = bryten_heresy.205.a
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:petrobrusian_council_stance_divorce = flag:petrobrusian_council_stance_no_divorce	}
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_petrobrusian_no_divorce = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.205.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.205.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_petrobrusian_no_divorce = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.205.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.205.a.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_petrobrusian_approve_divorce = yes

					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 0
		}
	}
	option = {# Allow Divorce
		name = bryten_heresy.205.b
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:petrobrusian_council_stance_divorce = flag:petrobrusian_council_stance_yes_divorce }
			}
		}
		if = {# going against Peter of Bruys himself is costly
				limit = { scope:petrobrusian_priest = { has_character_flag = petrobrusian_priest_is_peter }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_petrobrusian_approve_divorce = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.205.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.205.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_petrobrusian_approve_divorce = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.205.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.205.b.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_petrobrusian_no_divorce = yes

					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 0
		}
	}
	option = {# The Clergy decide
		name = bryten_heresy.205.d

		# We take scope:petrobrusian_priest's preference.
		if = {# No Divorce
			limit = { scope:petrobrusian_council_stance_divorce = flag:petrobrusian_council_stance_no_divorce }
			bryten_heresy_council_petrobrusian_no_divorce = yes
		}
		if = {# Allow Divorce
			limit = { scope:petrobrusian_council_stance_divorce = flag:petrobrusian_council_stance_yes_divorce }
			bryten_heresy_council_petrobrusian_approve_divorce = yes
		}

		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 100
		}
	}
	
	after = {
		trigger_event = {
			id = bryten_heresy.206
			days = { 5 10 }
		}
	}

}
# Council: Pilgrimage
scripted_effect bryten_heresy_council_petrobrusian_no_pilgrimage = {
	faith:petrobrusian = { 
		add_doctrine = doctrine_pilgrimage_forbidden 
	}
}
scripted_effect bryten_heresy_council_petrobrusian_yes_pilgrimage = {
	faith:petrobrusian = { 
		hidden_effect = { remove_doctrine = doctrine_pilgrimage_forbidden }
		add_doctrine = doctrine_pilgrimage_encouraged 
	}
}
bryten_heresy.206 = {# Council: Pilgrimage
	type = character_event
	title = bryten_heresy.206.t
	desc = bryten_heresy.206.desc
	theme = martial
	left_portrait = {
		character = scope:petrobrusian_council_host
		animation = personality_honorable
	}
	right_portrait = {
		character = scope:petrobrusian_priest_at_council
		animation = chaplain
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Check to see if scope:petrobrusian_priest around for the pictures.
		## Clear the old scope if applicable.
		if = {
			limit = { exists = scope:petrobrusian_priest_at_council }
			clear_saved_scope = petrobrusian_priest_at_council
		}
		## Now try to refresh it.
		scope:petrobrusian_priest = {
			if = {
				limit = { is_physically_able = yes }
				save_scope_as = petrobrusian_priest_at_council
			}
		}
	}

	option = {# No Pilgrimage
		name = bryten_heresy.206.a
		trigger = { 
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:petrobrusian_council_stance_pilgrimage = flag:petrobrusian_council_stance_forbid_pilgriamge }
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_petrobrusian_no_pilgrimage = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.206.a.tt.success
					send_interface_toast = {
						title = bryten_heresy.206.a.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_petrobrusian_no_pilgrimage = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.206.a.tt.failure
					send_interface_toast = {
						title = bryten_heresy.206.a.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_petrobrusian_yes_pilgrimage = yes
					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 0
		}
	}
	option = {# Yes Pilgrimage
		name = bryten_heresy.206.b
		trigger = {
			OR = {
				NOT = {	scope:conclave_engagement = flag:defaulted 	} 
				NOT = {	scope:petrobrusian_council_stance_pilgrimage = flag:petrobrusian_council_stance_allow_pilgrimage }
			}
		}
		if = {# going against Peter of Bruys himself is costly
				limit = { scope:petrobrusian_priest = { has_character_flag = petrobrusian_priest_is_peter }
			}
			add_piety = {
				value = bryten_heretic_council_oppose_founder_value
				multiply = -1
			}
		}
		# Piety path.
		if = {
			limit = { scope:conclave_engagement = flag:piety }
			# Pay the piety tax.
			add_piety = {
				value = bryten_heretic_council_cost_value
				multiply = -1
			}
			# Get your results.
			bryten_heresy_council_petrobrusian_yes_pilgrimage = yes
		}
		# Debate path.
		if = {
			limit = { scope:conclave_engagement = flag:debate }
			duel = {
				skill = learning
				value = high_skill_rating
				# You sway the priests.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = 3.5
						min = -49
					}
					desc = bryten_heresy.206.b.tt.success
					send_interface_toast = {
						title = bryten_heresy.206.b.tt.success
						left_icon = scope:council_1_venue
						bryten_heresy_council_petrobrusian_yes_pilgrimage = yes
					}
				}
				# The clergy ignore you.
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -3.5
						min = -49
					}
					desc = bryten_heresy.206.b.tt.failure
					send_interface_toast = {
						title = bryten_heresy.206.b.tt.failure
						left_icon = scope:council_1_venue
						bryten_heresy_council_petrobrusian_no_pilgrimage = yes

					}
				}
			}
		}
		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 0
		}
	}
	option = {# Clergy Decide
		name = bryten_heresy.206.d

		if = {# No Pilgrimages
			limit = { scope:petrobrusian_council_stance_pilgrimage = flag:petrobrusian_council_stance_forbid_pilgriamge }
			bryten_heresy_council_petrobrusian_no_pilgrimage = yes
		}
		if = {# Yes Pilgrimages
			limit = { scope:petrobrusian_council_stance_pilgrimage = flag:petrobrusian_council_stance_allow_pilgrimage }
			bryten_heresy_council_petrobrusian_yes_pilgrimage = yes
		}
		ai_chance = {
			# The AI should just let the scope:petrobrusian_priest pick.
			base = 100
		}
	}

	after = {
		# Progress the conclave.
		trigger_event = {
			id = bryten_heresy.207
			days = {5 10}
		}
	}
}
# council results
bryten_heresy.207 = {# The church council arrives at their final important doctrinal conclusions.
	type = character_event
	title = bryten_heresy.207.t
	desc = {
		desc = bryten_heresy.207.desc.intro
		first_valid = {# Priesthood
			triggered_desc = {# Spiritual + Hof
				trigger = {	faith:petrobrusian = { has_doctrine = doctrine_spiritual_head } }
				desc = bryten_heresy.207.desc.hof
			}
			triggered_desc = {# Spiritual 
				trigger = {
					faith:petrobrusian = { 
						NOT = {	has_doctrine = doctrine_spiritual_head }
						has_doctrine = doctrine_theocracy_temporal 
					}
				}
				desc = bryten_heresy.207.desc.priests
			}
			triggered_desc = {# Lay Clergy
				trigger = {	faith:petrobrusian = { has_doctrine = doctrine_theocracy_lay_clergy }	}
				desc = bryten_heresy.207.desc.lay
			}
		}
		first_valid = {# female clergy
			triggered_desc = {# No Female Clergy
				trigger = {	faith:petrobrusian = { has_doctrine = doctrine_clerical_gender_male_only } }
				desc = bryten_heresy.207.desc.male_only
			}
			triggered_desc = {# Yes Female Clergy
				trigger = {	faith:petrobrusian = { has_doctrine = doctrine_clerical_gender_either }	}
				desc = bryten_heresy.207.desc.female_clergy
			}
		}
		first_valid = {# Divorce
			triggered_desc = {# No Divorce
				trigger = {	faith:petrobrusian = { has_doctrine = doctrine_divorce_disallowed } }
				desc = bryten_heresy.207.desc.divorce_banned
			}
			triggered_desc = {# Yes Divorce
				trigger = {	faith:petrobrusian = { has_doctrine = doctrine_divorce_approval } }
				desc = bryten_heresy.207.desc.divorce_allowed
			}
		}
		first_valid = {# Pilgrimage
			triggered_desc = {# No Pilgrimage
				trigger = {	faith:petrobrusian = { has_doctrine = doctrine_pilgrimage_forbidden } }
				desc = bryten_heresy.207.desc.pilgrimage_forbidden
			}
			triggered_desc = {# Yes Pilgrimage
				trigger = {	faith:petrobrusian = { has_doctrine = doctrine_pilgrimage_encouraged } }
				desc = bryten_heresy.207.desc.pilgrimage_allowed
			}
		}
		# Outro.
		desc = bryten_heresy.207.desc.outro
	}
	theme = faith
	left_portrait = {
		character = scope:petrobrusian_council_host
		animation = personality_bold
	}
	right_portrait = {
		character = scope:petrobrusian_priest_at_council
		animation = chancellor
	}
	override_background = { reference = temple_scope }

	immediate = {
		# Music!
		play_music_cue = "mx_cue_sacredrite"
		faith:petrobrusian = {# the Council is over and now is formulized
			remove_doctrine = heretic_movement_doctrine
			change_fervor = { 
				value = 50
				desc = bryten_fervor_gain_petrobrusian_council	
			} 
		}
		# Now let's display our choices.
		faith:petrobrusian = {
			show_as_tooltip = {
				# Gnosticism.
				if = {
					limit = { has_doctrine = doctrine_pluralism_righteous }
					add_doctrine = doctrine_pluralism_righteous
				}
				if = {
					limit = { has_doctrine = doctrine_pluralism_righteous }
					add_doctrine = doctrine_pluralism_righteous
				}
				if = {
					limit = { has_doctrine = doctrine_pluralism_pluralistic }
					add_doctrine = doctrine_pluralism_pluralistic
				}
				# Priesthood.
				if = {
					limit = { has_doctrine = doctrine_spiritual_head }
					add_doctrine = doctrine_theocracy_temporal
					add_doctrine = doctrine_spiritual_head
				}
				if = {
					limit = { 
						has_doctrine = doctrine_theocracy_temporal 
						NOT = { has_doctrine = doctrine_spiritual_head }
					}
					add_doctrine = doctrine_theocracy_temporal
				}
				if = {
					limit = { has_doctrine = doctrine_theocracy_lay_clergy }
					add_doctrine = doctrine_theocracy_lay_clergy
				}
				# Wealth.
				if = {
					limit = { has_doctrine = tenet_communal_possessions }
					add_doctrine = tenet_communal_possessions
				}
				if = {
					limit = { has_doctrine = tenet_apostolic_poverty }
					add_doctrine = tenet_apostolic_poverty
				}
				if = {
					limit = { has_doctrine = tenet_pure_priesthood }
					add_doctrine = tenet_pure_priesthood
				}
				# Pacifism.
				if = {
					limit = { has_doctrine = tenet_armed_pilgrimages }
					add_doctrine = tenet_armed_pilgrimages
				}
				if = {
					limit = { has_doctrine = tenet_pacifism }
					add_doctrine = tenet_pacifism
				}
				if = {
					limit = { has_doctrine = tenet_unrelenting_faith }
					add_doctrine = tenet_unrelenting_faith
				}
			}


		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:bryten_petrobrusian_council_completed
		}


	}

	option = {
		name = bryten_heresy.207.a
		add_piety = major_piety_gain

	}

	after = {
		# Clean up the story.
		every_player = {# letting players know that the petrobrusian church has been formalized
			trigger_event = {
				id = bryten_heresy.208
				days = {5 10}
			}
		}
	}
}
bryten_heresy.208 = {# petrobrusian Council(let players know)
	type = character_event
	title = bryten_heresy.208.t
	desc = bryten_heresy.208.desc
	theme = faith	


	option = {# Condemn the heretic
		name = bryten_heresy.208.a
	}
}





